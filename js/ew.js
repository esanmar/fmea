/**
 * JavaScript for PHPMaker 2020
 * @license (C)2002-2020 e.World Technology Ltd.
 */
var currentPageID,currentForm,currentSearchForm,currentAdvancedSearchForm,$rowindex$=null;ew.IS_SCREEN_SM_MIN=window.matchMedia("(min-width: 768px)").matches,ew.MOBILE_DETECT=new MobileDetect(window.navigator.userAgent),ew.IS_MOBILE=!!ew.MOBILE_DETECT.mobile(),window.exportCharts={},window.drillDownCharts={},ew.extend=Object.assign||jQuery.extend,ew.extend(ew,function(e,t){var a=e(document),n=e("body"),i=new URL(window.location);t.addSpinner();var r=t.removeSpinner;function o(){var t=n.data("_spinner");t&&t.cancel(),t=e.later(500,null,function(){!0!==a.data("_ajax")&&r()}),n.data("_spinner",t)}var s=function(t){var a=e.isString(t)?t:E(t).id;return arguments.callee[a]};function l(a){var n=a&&a.target?a.target:document;e(n).find(".ew-icon").closest("a, button").add(".ew-tooltip").tooltip({container:"body",trigger:t.IS_MOBILE?"manual":"hover",placement:"bottom",sanitizeFn:t.sanitizeFn})}function d(a){var n=a&&a.target?a.target:document;e.fn.pStrength&&void 0!==t.MIN_PASSWORD_STRENGTH&&e(n).find(".ew-password-strength").each(function(){var a=e(this);a.data("pStrength")||a.pStrength({changeBackground:!1,backgrounds:[],passwordValidFrom:t.MIN_PASSWORD_STRENGTH,onPasswordStrengthChanged:function(a,n){var i=e(this),r=e("[id='"+i.attr("data-password-strength")+"']"),o=r.find(".progress-bar");if(r.width(i.outerWidth()),i.val()){var s=n+"%";n<25?o.addClass("bg-danger").removeClass("bg-warning bg-info bg-success"):n<50?o.addClass("bg-warning").removeClass("bg-danger bg-info bg-success"):n<75?o.addClass("bg-info").removeClass("bg-danger bg-warning bg-success"):o.addClass("bg-success").removeClass("bg-danger bg-warning bg-info"),o.css("width",s),n>25&&(s=t.language.phrase("PasswordStrength").replace("%p",s)),o.html(s),r.removeClass("d-none").show(),i.data("validated",n>=t.MIN_PASSWORD_STRENGTH)}else r.addClass("d-none").hide(),i.data("validated",!1)}})}),e.fn.pGenerator&&e(n).find(".ew-password-generator").each(function(){var a=e(this);a.data("pGenerator")||a.pGenerator({passwordLength:t.GENERATE_PASSWORD_LENGTH,uppercase:t.GENERATE_PASSWORD_UPPERCASE,lowercase:t.GENERATE_PASSWORD_LOWERCASE,numbers:t.GENERATE_PASSWORD_NUMBER,specialChars:t.GENERATE_PASSWORD_SPECIALCHARS,onPasswordGenerated:function(t){var a=e(this);e("#"+a.attr("data-password-field")).val(t).change().focus().triggerHandler("click"),e("#"+a.attr("data-password-confirm")).val(t),e("#"+a.attr("data-password-strength")).addClass("d-none").hide()}})})}function c(e,a){var n=t.RELATIVE_PATH+t.API_URL,i=new URLSearchParams(a);t.USE_URL_REWRITE?n+=e?e+"/":"":e&&i.set(t.API_ACTION_NAME,e);var r=i.toString();return n+(r?"?"+r:"")}function u(){var a,n,i,r,o,s=e("#ew-timer"),l=t.SESSION_KEEP_ALIVE_INTERVAL>0||t.IS_LOGGEDIN&&t.IS_AUTOLOGIN,d=function(){e.get(c(t.API_SESSION_ACTION),{rnd:Me()},function(a){t.ANTIFORGERY_TOKEN=a,e("input:hidden[name="+t.TOKEN_NAME+"]").val(a)})};s.find(".modal-footer .btn-primary").click(function(e){i&&i.cancel(),s.modal("hide"),d(),!l&&t.SESSION_TIMEOUT>0&&f()});var u=function(){o=t.SESSION_TIMEOUT_COUNTDOWN,(a=t.SESSION_TIMEOUT-t.SESSION_TIMEOUT_COUNTDOWN)<0&&(a=0,o=t.SESSION_TIMEOUT),i&&i.cancel(),n&&n.cancel()},p=function(){r&&r.cancel(),i=e.later(1e3,null,function(){o>0?(s.find(".modal-body").html('<p class="text-danger">'+t.language.phrase("SessionWillExpire").replace("%s",o)+"</p>"),s.modal("show")):(s.find(".modal-body").html('<p class="text-danger">'+t.language.phrase("SessionExpired")+"</p>"),u(),setTimeout(function(){s.modal("hide"),window.location=t.TIMEOUT_URL+"?expired=1"},1e3)),o--},null,!0)},f=function(){u(),n=e.later(1e3*a,null,p)};if(l){var h=t.SESSION_KEEP_ALIVE_INTERVAL>0?t.SESSION_KEEP_ALIVE_INTERVAL:t.SESSION_TIMEOUT-t.SESSION_TIMEOUT_COUNTDOWN;h<=0&&(h=60),r=e.later(1e3*h,null,d,null,!0)}else t.SESSION_TIMEOUT>0&&f()}function p(t){var a=t&&t.target?t.target:document;e(a).find(".ew-export-link[href]:not(.ew-email):not(.ew-print):not(.ew-xml)").click(function(t){var a=e(this).attr("href");a&&"#"!=a&&h(a),t.preventDefault()})}function f(t){var a=t&&t.target?t.target:document,n=e(a),i=n.find("input[type=checkbox].ew-multi-select"),r=function(e){var t=i.filter("[name^='"+e+"_']"),a=t.length,n=t.filter(":checked").length;t.closest("form").find("input[type=checkbox]#"+e).prop("checked",n==a).prop("indeterminate",n!=a&&0!=n)};i.click(function(e){r(this.name.split("_")[0])}),n.find("input[type=checkbox].ew-priv:not(.ew-multi-select)").each(function(){r(this.id)})}function h(e,i){var r,o=window.location!=window.parent.location&&window.parent.jQuery?window.parent.jQuery:jQuery;n.css("cursor","wait"),t.SHOW_EXPORT_DIALOG&&((r=o("#ew-message-box")).find(".modal-body").html("<p>"+t.language.phrase("Exporting")+"</p>"),r.find(".modal-footer button").prop("disabled",!0),r.modal("show"));var s=i?"POST":"GET";o.fileDownload(e,{httpMethod:s,data:i||null,successCallback:function(e){t.SHOW_EXPORT_DIALOG&&r.modal("hide"),a.trigger("export",[{type:"done",url:e}])},failCallback:function(e,n){t.SHOW_EXPORT_DIALOG&&r.find(".modal-body").html("<div class='text-danger'><h4>"+t.language.phrase("FailedToExport")+"</h4>"+e+"</div>"),a.trigger("export",[{type:"fail",url:n}])}}).always(function(){t.SHOW_EXPORT_DIALOG&&r.find(".modal-footer button").prop("disabled",!1),n.css("cursor","default"),a.trigger("export",[{type:"always",url:e}])})}function g(n){if(t.LAZY_LOAD){var i=n&&n.target?n.target:document,r=e(i),o=[];r.find("img.ew-lazy").each(function(a){var n=this,i=e(n).data("src"),s=(r.attr("id")||"")+"lazyload"+Me();o.push(s),loadjs("img!"+i,s,{success:function(){n.src=i},numRetries:t.LAZY_LOAD_RETRIES})}),loadjs.ready(o,function(){a.trigger("lazyload")})}}function m(a){if(t.USE_COLORBOX){var n=a&&a.target?a.target:document,i=t.extend({},t.lightboxSettings,{title:t.language.phrase("LightboxTitle"),current:t.language.phrase("LightboxCurrent"),previous:t.language.phrase("LightboxPrevious"),next:t.language.phrase("LightboxNext"),close:t.language.phrase("LightboxClose"),xhrError:t.language.phrase("LightboxXhrError"),imgError:t.language.phrase("LightboxImgError")});e(n).find(".ew-lightbox").each(function(){var a=e(this);a.colorbox(t.extend({rel:a.data("rel")},i))})}}function v(a){if(t.EMBED_PDF){var n=a&&a.target?a.target:document,i=t.extend({},t.PDFObjectOptions);e(n).find(".ew-pdfobject").not(":has(.pdfobject)").each(function(){var a=e(this),n=a.data("url"),r=a.html();n&&PDFObject.embed(n,this,t.extend(i,{fallbackLink:r}))})}}function w(a){var n=a&&a.target?a.target:document,i=e(n);i.find("input[data-toggle=tooltip],textarea[data-toggle=tooltip],select[data-toggle=tooltip]").each(function(){var a=e(this);a.tooltip(t.extend({html:!0,placement:"bottom",sanitizeFn:t.sanitizeFn},a.data()))}),i.find("a.ew-tooltip-link").each(ve),i.find(".ew-tooltip").tooltip({placement:"bottom",sanitizeFn:t.sanitizeFn}),i.find(".ew-popover").popover({sanitizeFn:t.sanitizeFn})}function b(t){if(e.isString(t))try{return JSON.parse(t)}catch(e){return}return t}function x(i,r){var l=this;this.id=i,this.pageId=r,this.$element=null,this._form=null,this.initSearchPanel=!1,this.modified=!1,this.validateRequired=!0,this.validate=null,this.emptyRow=null,this.multiPage=null,this.autoSuggests={},this.disableForm=function(){var t=this.getForm();e(t).find(":submit:not(.dropdown-toggle)").prop("disabled",!0).addClass("disabled")},this.enableForm=function(){var t=this.getForm();e(t).find(":submit:not(.dropdown-toggle)").prop("disabled",!1).removeClass("disabled")},this.appendHidden=function(t){var a=this.getForm(),n=e(a),i=e(t).closest(".ew-form"),r=i.attr("id")+"$"+t.name;if(!n.find("input:hidden[name='"+r+"']")[0]){var o=i.find('[name="'+t.name+'"]').serializeArray();o.length?o.forEach(function(t,a){e('<input type="hidden" name="'+r+'">').val(t.value).appendTo(n)}):e('<input type="hidden" name="'+r+'">').val("").appendTo(n)}},this.canSubmit=function(){var t=this.getForm(),a=e(t);if(this.disableForm(),this.updateTextArea(),!this.validate||this.validate()&&!a.find(".is-invalid")[0]){a.find("input[name^=sv_], input[name^=p_], .ew-template input").prop("disabled",!0),a.find("[data-readonly=1][disabled]").prop("disabled",!1);var n=e(a.find("input[name='detailpage']").map(function(e,t){return a.find("#"+t.value).get()}));return n.length>1&&n.each(function(t,a){e(a).find(":input").each(function(e,t){if(/^(fn_)?(x|o)\d*_/.test(t.name)){var i=n.not(a).find(":input[name='"+t.name+"']");i.length&&(l.appendHidden(t),i.each(function(){l.appendHidden(this)}))}})}),!0}return this.enableForm(),!1},this.submit=function(e){var t=this.getForm();return this.canSubmit()&&(e&&(t.action=e),t.submit()),!1},this.lists=function(e){return e=e.replace(/^[xy](\d*|\$rowindex\$)_/,"x_"),this.lists[e]},this.compileTemplates=function(){for(var t in this.lists){var a=this.lists[t];a.template&&e.isString(a.template)&&(a.template=e.templates(a.template))}},this.getForm=function(){return this._form||(this.$element=e("#"+this.id),this.$element.is("form")?this._form=this.$element[0]:this.$element.is("div")&&(this._form=this.$element.closest("form")[0])),this._form},this.getElement=function(t){return this.$element||(this.$element=e("#"+this.id)),t?W(t,this.$element):this.$element[0]},this.getElements=function(t){this.$element||(this.$element=e("#"+this.id));var a="[name='"+t+"']";a="input"+a+",select"+a+",textarea"+a+",button"+a;var n=this.$element.find(a);return 0==n.length?null:1==n.length&&n.is(":not([type=checkbox]):not([type=radio])")?n[0]:n.get()},this.updateLists=function(n){if(n!==$rowindex$){var i=this.getForm(),r=!e.isUndefined(n),s=function(e){return r?e.replace(/^x_/,"x"+n+"_"):e},d=Object.keys(this.lists).map(function(e){return"[name='"+s(e)+"']"}).join();if(d&&i.querySelector(d)){var c=[],u=[];for(var p in this.compileTemplates(),this.lists){var f=this.lists[p].parentFields.slice(),h=this.lists[p].ajax;if(r){p=s(p);for(var g=0,m=f.length;g<m;g++)f[g]=s(f[g])}if(e.isBoolean(h)){var v=f.map(function(e){return J(e,i)});c.push([p,v,h,!1])}else S.call(this,p,f,null,!1)}for(g=0;g<c.length;g++)u.push(new Promise(function(e,a){setTimeout(function(){e(S.apply(l,c.shift()))},t.AJAX_DELAY*g)}));Promise.all(u).then(function(){a.trigger("updatedone",[{source:l,target:i}])}).catch(function(e){console.log(e)})}else o()}},this.createAutoSuggest=function(e){var a=e.id;e.form=this;var n=t.extend({},t.autoSuggestSettings,{limit:t.AUTO_SUGGEST_MAX_ENTRIES},e),i=a.replace(/^[xy](\d*|\$rowindex\$)_/,"x_"),r=t.extend({},l.lists[i],{options:null,template:null});l.autoSuggests[a]instanceof le||(n.data=r),l.autoSuggests[a]=new le(n)},this.initEditors=function(){var t=this.getForm();e(t.elements).filter("textarea.editor").each(function(t,a){var n=e(a).data("editor");!n||n.active||n.name.includes("$rowindex$")||n.create()})},this.updateTextArea=function(t){var a=this.getForm();e(a.elements).filter("textarea.editor").each(function(a,n){var i=e(n).data("editor");return!(i&&(!t||i.name==t))||(i.save(),!t&&void 0)})},this.destroyEditor=function(t){var a=this.getForm();e(a.elements).filter("textarea.editor").each(function(a,n){var i=e(n).data("editor");return!(i&&(!t||i.name==t))||(i.destroy(),!t&&void 0)})},this.onError=function(e,t){return D(this,e,t)},this.initUpload=function(){var a=this.getForm();e(a.elements).filter("input:file:not([name*='$rowindex$'],[id='importfiles'])").each(function(a){e.later(t.AJAX_DELAY*a,null,Fe,this)})},this.setupFilters=function(a,i){var r=this.id,o=this.filterList?this.filterList.data:null,s=e(".ew-save-filter[data-form="+r+"]").toggleClass("disabled",!o),d=e(".ew-delete-filter[data-form="+r+"]").toggleClass("disabled",!i.length).toggleClass("dropdown-toggle",!!i.length),c=d.parent("li").toggleClass("dropdown-submenu dropdown-hover",!!i.length).toggleClass("disabled",!i.length),u=s.parent("li").toggleClass("disabled",!o),p=(e(a.target),function(a,i){"Client"==t.SEARCH_FILTER_OPTION?window.localStorage.setItem(a+"_filters",JSON.stringify(i)):"Server"==t.SEARCH_FILTER_OPTION&&(n.css("cursor","wait"),e.ajax(we(),{type:"POST",dataType:"json",data:{ajax:"savefilters",filters:JSON.stringify(i)}}).done(function(e){e[0]&&e[0].success&&(l.filterList.filters=i)}).always(function(){n.css("cursor","default")}))});if(u.off("click.ew").on("click.ew",function(e){if(u.hasClass("disabled"))return!1;_(t.language.phrase("EnterFilterName"),function(e){i.push([e,o]),p(r,i)},!0)}).prevAll().remove(),d.next("ul.dropdown-menu").remove(),i.length){d.closest("ul.dropdown-menu");var f=e("<ul class='dropdown-menu'></ul>");for(var h in i)e.isArray(i[h])&&(e('<li><a class="dropdown-item" data-index="'+h+'" href="#" onclick="return false;">'+i[h][0]+"</a></li>").on("click",function(a){var n=e(this).find("a[data-index]").data("index");_(t.language.phrase("DeleteFilterConfirm").replace("%s",i[n][0]),function(e){e&&(i.splice(n,1),p(r,i))})}).appendTo(f),e('<li><a class="dropdown-item ew-filter-list" data-index="'+h+'" href="#" onclick="return false;">'+i[h][0]+"</a></li>").insertBefore(u).on("click",function(a){var n=e(this).find("a[data-index]").data("index");e("<form>").attr({method:"post",action:we()}).append(e("<input type='hidden'>").attr({name:"cmd",value:"resetfilter"}),e("<input type='hidden'>").attr({name:t.TOKEN_NAME,value:t.ANTIFORGERY_TOKEN}),e("<input type='hidden'>").attr({name:"filter",value:JSON.stringify(i[n][1])})).appendTo("body").submit()}));e("<li class='dropdown-divider'></li>").insertBefore(u),c.append(f)}},this.init=function(){if(!this._initiated){"Client"==t.SEARCH_FILTER_OPTION&&window.localStorage||"Server"==t.SEARCH_FILTER_OPTION&&t.IS_LOGGEDIN&&!t.IS_SYS_ADMIN&&""!=t.CURRENT_USER_NAME?(e(".ew-filter-option."+this.id+" .ew-btn-dropdown").on("show.bs.dropdown",function(a){var n=[];if("Client"==t.SEARCH_FILTER_OPTION){var i=window.localStorage.getItem(l.id+"_filters");i&&(n=b(i)||[])}else"Server"==t.SEARCH_FILTER_OPTION&&(n=l.filterList&&l.filterList.filters?l.filterList.filters:[]);var r=e.grep(n,function(t){if(e.isArray(t)&&2==t.length)return t});l.setupFilters(a,r)}),e(".ew-filter-option").show()):e(".ew-filter-option").hide();var a=this.getForm(),n=e(a);if(a){this.compileTemplates();var i=/s(ea)?rch$/.test(this.id);i&&this.initSearchPanel&&!y(a)&&e("#"+this.id+"-search-panel").removeClass("show"),e(".ew-search-toggle[data-form="+this.id+"]").on("click.bs.button",function(){e("#"+e(this).data("form")+"-search-panel").collapse("toggle")}),e(".ew-table .ew-search-operator").text().trim()||e(".ew-table .ew-search-operator").parent("td").hide(),i&&e(".ew-highlight[data-form="+this.id+"]").on("click.bs.button",function(){e("span."+e(this).data("name")).toggleClass("ew-highlight-search")}),i&&n.find("select[id^=z_]").each(function(){"BETWEEN"!=e(this).change().val()&&n.find("#w_"+this.id.substr(2)).change()}),this.multiPage&&this.multiPage.render(),loadjs.ready(["editor"],this.initEditors.bind(this)),this.updateLists(),this.initUpload(),this.$element.is("form")&&(n.submit(function(e){return l.submit()}),n.find("[data-field], .ew-priv").change(function(){t.CONFIRM_CANCEL&&(l.modified=!0)}),n.find("#btn-cancel[data-href]").click(function(){l.updateTextArea();var n=e(this).data("href");l.modified&&y(a)?_(t.language.phrase("ConfirmCancel"),function(e){e&&(window.location=n)}):window.location=n})),this._initiated=!0,this.$element.data("form",this)}}},s[this.id]=this}function _(t,a,n){var i=e("#ew-prompt"),r=i.find(".modal-body").empty();if(n){r.append('<div class="form-group row"><label class="col-form-label">'+t+'</label><input type="text" class="form-control d-block w-100"></div>');var o=r.find("input").click(function(){o.removeClass("is-invalid")});i.find(".modal-footer .btn-primary").off().click(function(t){var n=o.val().trim();""==n?(o.addClass("is-invalid"),o[0].focus()):(i.modal("hide"),e.isFunction(a)&&a(n))}),i.on("shown.bs.modal",function(e){o[0].focus()})}else r.append("<div>"+t+"</div>"),i.find(".modal-footer .btn-primary").off().click(function(t){i.modal("hide"),e.isFunction(a)&&a(!0)}),a?i.find(".modal-footer .btn-default").off().click(function(t){i.modal("hide"),e.isFunction(a)&&a(!1)}).show():i.find(".modal-footer .btn-default").hide();i.modal("show")}function E(t){if(t instanceof x)return t.$element[0];var a=e(t),n=a.closest(".ew-form");return n[0]||(n=a.closest(".ew-grid, .ew-multi-column-grid").find(".ew-form").not(".ew-pager-form")),n[0]}function y(t){for(var a=e(t).find("[name^=x_][value!='{value}'],[name^=y_],[name^=z_],[name^=w_],[name=psearch]").filter(":enabled").get(),n=0,i=a.length;n<i;n++){var r=a[n];if(/^(z|w)_/.test(r.name)){if(/^IS/.test(e(r).val()))return!0}else if("checkbox"==r.type||"radio"==r.type){if(r.checked)return!0}else if("select-one"==r.type||"select-multiple"==r.type){if(e(r).val())return!0}else if(("text"==r.type||"hidden"==r.type||"textarea"==r.type)&&r.value)return!0}return!1}function S(t,n,i,r){var o=this.$element?this.$element[0]:this.form?this.form:null;if(o&&((this._form?this:s[o.id])&&(this.form&&e.isUndefined(t)?t=s(this).lists[this.name.replace(/^(sv_)?[xy]\d*_/,"x_")].childFields.slice():e.isString(t)&&(t=G(t,o)),t&&(!e.isArray(t)||0!=t.length)))){var l=this,d=Promise.resolve();if(e.isArray(t)&&e.isString(t[0])){for(var c=0,u=t.length;c<u;c++){var p=t[c].split(" ");if(1==p.length&&l.form){var f=Z(l,!1).match(/^([xy]\d*_)/);f&&(t[c]=t[c].replace(/^([xy]\d*_)/,f[1]))}var h=G(t[c],o),g=[];if(2==p.length&&e.isArray(h)){var m=e(h);m.each(function(){if(!g.includes(this.name)){g.push(this.name);var e=m.filter("[name='"+this.name+"']"),t=e.attr("type"),a=["radio","checkbox"].includes(t)?e.get():e[0];d=d.then(T.bind(l,a,n,i,r))}})}else d=d.then(T.bind(l,h,n,i,r))}var v=s(l).lists[l.name.replace(/^[xy]\d*_/,"x_")];v&&e.isArray(v.autoFillTargetFields)&&v.autoFillTargetFields[0]&&(d=d.then(me.bind(null,l)))}else d=d.then(T.bind(l,t,n,i,r));return d.then(function(){a.trigger("updatedone",[{source:l,target:t}])})}}function T(n,i,r,o){var l=this,d=e.makeArray(arguments),u=J(n),p=Z(n,!1);if(p){var f=E(n);if(f&&f.id){var h=s[f.id];if(h){var g=p.match(/^([xy])(\d*)_/),m=g?g[1]:"",v=g?g[2]:"",w=p.replace(/^([xy])(\d*)_/,"x_"),b=[],x=h.lists[w];if(e.isUndefined(i)&&(i=x.parentFields.slice(),""!=v))for(var _=0,y=i.length;_<y;_++){1==i[_].split(" ").length&&(i[_]=i[_].replace(/^x_/,"x"+v+"_"))}if(e.isArray(i)&&i.length>0)if(e.isArray(i[0]))b=i;else if(e.isString(i[0]))for(_=0,y=i.length;_<y;_++)b.push(J(i[_],f));k(n)||q(n);var T=function(t){var i=Z(n);t.forEach(function(e){var t={data:e,parents:b,valid:!0,name:i,form:f};a.trigger("addoption",[t]),t.valid&&ie(n,e,f)}),!n.options&&n.length&&(re(n),n=G(p,f)),oe(n,u),!1!==o&&(!n.options&&n.length?e(n).first().triggerHandler("click"):e(n).first().change())};e.isUndefined(r)&&(r=x.ajax);var A=function(){/s(ea)?rch$/.test(f.id)&&"x"==m&&(d[0]=p.replace(/^x_/,"y_"),S.apply(l,d))};if(!e.isBoolean(r)||e.isArray(x.options)&&x.options.length>0){var I=x.options;return T(I),A(),I}var C=Z(n),R=t.extend({page:x.page,field:x.field,ajax:"updateoption",name:C},O("#p_"+p,f));k(n)&&l._form?R.v0=u[0]?u[0]:Me():P(n)&&(R.v0=u[0]?e(n).data("multiple")?u.join(t.MULTIPLE_OPTION_SEPARATOR):u[0]:Me());_=0;for(var N=b.length;_<N;_++)R["v"+(_+1)]=b[_].join(t.MULTIPLE_OPTION_SEPARATOR);return e.ajax(c(t.API_LOOKUP_ACTION),{type:"POST",dataType:"json",data:R,async:r}).done(function(e){var t=e.records||[];return T(t),A(),t})}}}}function O(t,a){t=t.replace(/\[\]$/,"");var n={},i=((a=e.isString(a)?/^#/.test(a)?a:"#"+a:a)?e(a).find(t):e(t)).val();i&&new URLSearchParams(i).forEach(function(e,t){n[t]=e});return n}function A(e){return e&&["1","y","t","true"].includes(e.toLowerCase())}function I(a,i,r,o,s,l){if(!a)return!1;var d=e(a),c=d.attr("target"),u=d.attr("action"),p=s&&d.find("input[type=checkbox][name='key_m[]']")[0];if(p&&!F(a))return N(t.language.phrase("NoRecordSelected")),!1;if(o)if(e("iframe.ew-export").remove(),"email"==r&&(i+=("&"+e(l).serialize()).replace(/&export=email/i,"")),p){e("<iframe>").attr("name","ew-export-frame").addClass("ew-export d-none").appendTo(n);try{d.append(e("<input type='hidden'>").attr({name:"custom",value:"1"})).attr({action:i,target:"ew-export-frame"}).find("input[name=exporttype]").val(r).end().submit()}finally{d.attr({target:c||"",action:u}).find("input[name=custom]").remove()}}else e("<iframe>").attr({name:"ew-export-frame",src:i}).addClass("ew-export d-none").appendTo(n);else d.find("input[name=exporttype]").val(r),["xml","print"].includes(r)?d.submit():h(u,d.serialize());return!1}function C(t){var a=e(t);return t&&a.is(":hidden")&&a.data("editor")}function P(t){var a=e(t);return t&&a.is(":hidden")&&a.data("lookup")}function k(t){var a=e(t);return a[0]&&a.is(":hidden")&&a.data("autosuggest")}function R(e){return s(e).autoSuggests[e.id]}function N(a,n,i){if(t.IS_MOBILE)alert(a.replace(/<[^>]*>/g,"")),n&&setTimeout(n,100);else{var r=e("#ew-message-box");r.find(".modal-body").html('<p class="text-'+(i||"danger")+'">'+a+"</p>"),r.modal("show"),n&&r.off("hidden.bs.modal").on("hidden.bs.modal",n)}}function D(e,t,a){if(t.jquery){var n=t.attr("type");t="checkbox"==n||"radio"==n?t.get():t[0]}if(N(a,function(){L(t)}),e)if(e.multiPage)e.multiPage.gotoPageByElement(t);else if(e.$element.is("div")){var i=e.$element.closest(".tab-pane");i[0]&&!i.hasClass("active")&&i.closest(".tabbable, .ew-nav-tabs").find("a[data-toggle=tab][href='#"+i.attr("id")+"']").click()}return!1}function L(t){if(t){var a=e(t);if(C(t))return a.data("editor").focus();!t.options&&t.length?t=a.filter("[value!='{value}']")[0]:k(t)&&(t=R(t).input);var n=a.closest(".form-group, [id^='el']");P(t)?n.find(":button").on("click",function(){n.find(".is-invalid").removeClass("is-invalid")}):"checkbox"==t.type||"radio"==t.type?a.filter("[value!='{value}']").addClass("is-invalid").focus().one("click keypress keyup",function(){n.find(".is-invalid").removeClass("is-invalid")}):e(t).addClass("is-invalid").focus().select().parent().one("click keypress keyup",function(){n.find(".is-invalid").removeClass("is-invalid")})}}function M(e){return""!=J(e).join("")}function F(t){return e(t).find("input[type=checkbox][name='key_m[]']:checked",t).length>0}function $(t){t&&t.form&&e(t.form.elements).filter("input[type=checkbox][name^="+t.name+"_], [type=checkbox][name="+t.name+"]").not(t).not(":disabled").prop("checked",t.checked)}function j(a,n){var i=e(n),r=i.closest(".ew-table");r[0]&&(i.data("selected")?i.removeClass(r.data("rowhighlightclass")||"ew-table-highlight-row").removeClass(r.data("roweditclass")||"ew-table-edit-row").addClass(r.data("rowselectclass")||"ew-table-select-row"):[t.ROWTYPE_ADD,t.ROWTYPE_EDIT].includes(i.data("rowtype"))?i.removeClass(r.data("rowselectclass")||"ew-table-select-row").removeClass(r.data("rowhighlightclass")||"ew-table-highlight-row").addClass(r.data("roweditclass")||"ew-table-edit-row"):i.removeClass(r.data("rowselectclass")||"ew-table-select-row").removeClass(r.data("roweditclass")||"ew-table-edit-row").removeClass(r.data("rowhighlightclass")||"ew-table-highlight-row"))}function U(t){e(t.rows).each(function(t,a){var n=e(a);!n.data("checked")&&n.data("selected")&&(n.data("selected",!1),j(0,a))})}function H(t){var a=e(t);if(a.closest(".ew-table")[0]){var n=a.closest(".ew-table > tbody > tr");n.siblings("[data-rowindex='"+n.data("rowindex")+"']").addBack().each(function(t,a){var n=e(a);n.data("selected",n.data("checked"))})}}function Y(t){var a=e(t),n=a.closest(".ew-table")[0];if(n){U(n);var i=a.closest(".ew-table > tbody > tr");i.siblings("[data-rowindex='"+i.data("rowindex")+"']").addBack().each(function(t,a){e(a).data("selected",!0),j(0,a)})}}function B(a,n,i){var r=e(n),o=e(n.rows);if(n&&n.rows&&(i||!r.data("isset"))&&0!=n.tBodies.length){var s=function(a){var n=e(this);if(!n.data("selected")&&![t.ROWTYPE_ADD,t.ROWTYPE_EDIT].includes(n.data("rowtype"))){var i=n.closest(".ew-table");if(!i[0])return;n.siblings("[data-rowindex='"+n.data("rowindex")+"']").addBack().each(function(t,a){e(a).addClass(i.data("rowhighlightclass")||"ew-table-highlight-row")})}},l=function(a){var n=e(this);n.data("selected")||[t.ROWTYPE_ADD,t.ROWTYPE_EDIT].includes(n.data("rowtype"))||n.siblings("[data-rowindex='"+n.data("rowindex")+"']").addBack().each(j)},d=function(t){var a=e(this),n=a.closest(".ew-table")[0],i=e(t.target);if(n&&!i.hasClass("btn")&&!i.hasClass("ew-preview-row-btn")&&!i.is(":input")&&!a.data("checked")){var r=a.data("selected");U(n),a.siblings("[data-rowindex='"+a.data("rowindex")+"']").addBack().each(function(t,a){e(a).data("selected",!r),j(0,a)})}},c=o.filter("[data-rowindex=1]").length||o.filter("[data-rowindex=0]").length||1,u=o.filter(":not(.ew-template)").each(function(){e(this.cells).removeClass("ew-table-last-row").last().addClass("ew-table-last-col")}).get(),p=r.parentsUntil(".ew-grid","."+t.RESPONSIVE_TABLE_CLASS)[0];if(u.length)for(var f=1;f<=c;f++){var h=u[u.length-f];e(h.cells).each(function(){this.rowSpan==f&&e(this).addClass("ew-table-last-row").toggleClass("ew-table-border-bottom",!!p&&p.clientHeight>n.offsetHeight)})}var g=r.closest("form")[0],m=g&&e(g.elements).filter("input#action:not([value^=grid])").length>0;e(n.tBodies[n.tBodies.length-1].rows).filter(":not(.ew-template):not(.ew-table-preview-row)").each(function(a){var n=e(this);m&&!n.data("isset")&&([t.ROWTYPE_ADD,t.ROWTYPE_EDIT].includes(n.data("rowtype"))&&n.on("mouseover",function(){this.edit=!0}).addClass("ew-table-edit-row"),n.on("mouseover",s).on("mouseout",l).on("click",d),n.data("isset",!0));var i=a%(2*c)<c;n.toggleClass("ew-table-row",i).toggleClass("ew-table-alt-row",!i)}),z(a,r.closest(".ew-grid")[0],i),r.data("isset",!0)}}function z(a,n,i){var r=e(n);!n||!i&&r.data("isset")||(0!=(r.find("table.ew-multi-column-table").length?r.find("td[data-rowindex]").length:r.find("table.ew-table > tbody:first > tr:not(.ew-table-preview-row, .ew-template)").length)||r.find(".ew-grid-upper-panel, .ew-grid-lower-panel")[0]||r.hide(),r.find(".ew-grid-middle-panel:visible").hasClass(t.RESPONSIVE_TABLE_CLASS)&&r.width()>e(".content").width()&&(r.addClass("d-flex"),r.closest(".ew-detail-pages").addClass("d-block"),r.closest(".ew-form").addClass("w-100"),t.USE_OVERLAY_SCROLLBARS&&r.find(".ew-grid-middle-panel:not(.ew-preview-middle-panel)").overlayScrollbars(t.sidebarScrollbarsOptions)),r.data("isset",!0))}function G(t,a){var n="[name='"+t+"']",i=t.split(" ");2==i.length&&(n="[data-table='"+i[0]+"'][data-field='"+Z(i[1])+"']:not([name^=o]):not([name^='x$'])");a=e.isString(a)?/^#/.test(a)?a:"#"+a:a;n="input"+n+",select"+n+",textarea"+n+",button"+n;var r=a?e(a).find(n):e(n);return 1==r.length&&r.is(":not([type=checkbox]):not([type=radio])")?r[0]:r.get()}function W(t,a){a=e.isString(a)?"#"+a:a;var n="#"+t.replace(/([\$\[\]])/g,"\\$1")+",[name='"+t+"']";return a?e(a).find(n)[0]:e(n).first()[0]}function K(e,t){for(;e=e.parentNode;)if(e&&1==e.nodeType&&(!t||t(e)))return e;return null}function V(e,t){return String(e).toLowerCase()==String(t).toLowerCase()}function J(a,n){var i;e.isString(a)?i=2==a.split(" ").length?G(a):G(a,n):i=a;if(i.options)return e(i).find("option:selected[value!='']").map(function(){return this.value}).get();if(e.isNumber(i.length))return e(i).filter(":checked[value!='{value}']").map(function(){return this.value}).get();var r=e(i).data();return r.lookup&&r.multiple?i.value.split(t.MULTIPLE_OPTION_SEPARATOR):[i.value]}function X(t,a){var n;e.isString(t)?n=2==t.split(" ").length?G(t):G(t,a):n=t;return n.options?e(n).find("option:selected[value!='']").map(function(){return this.text}).get():e.isNumber(n.length)?e(n).filter(":checked[value!='{value}']").map(function(){return e(this).parent().text()}).get():k(n)?[R(n).input.value]:P(n)?e(n).parent().find(".ew-lookup-text .ew-option").map(function(){return e(this).text().trim()}).get():[n.value]}function Q(t){var a=Z(t);return e(t).closest(".form-group, [id^=el][id$='"+a.replace(/^([xy]\d*_)/,"")+"']").find("#dsl_"+a)}function q(t){if(t.options)for(var a="select-multiple"==t.type||!1===e(t).data("pleaseselect")||t.length>0&&""!=t.options[0].value?0:1,n=t.length-1;n>=a;n--)t.options[n]=null;else if(t.length){Z(t);Q(t).data("options",[]).find("div").first().empty()}else if(k(t)){var i=R(t);i._options=[],i.input.value="",t.value=""}else P(t)&&e(t).data("options",[])}function Z(t,a){var n=e.isString(t)?t:e(t).attr("name")||e(t).attr("id");return!1!==a?n.replace(/\[\]$/,""):n}function ee(t,a){var n=e(a).data("value-separator");return e.isArray(n)?n[t-1]:n||", "}function te(t,a){for(var n=t.df,i=2;i<=4;i++)if(t["df"+i]&&""!=t["df"+i]){var r=ee(i-1,a);if(e.isUndefined(r))break;""!=n&&(n+=r),n+=t["df"+i]}return n}function ae(e){return t.OPTION_HTML_TEMPLATE.replace(/\{value\}/g,e)}function ne(e,a){if(e.length>(a||t.MAX_OPTION_COUNT))return t.language.phrase("CountSelected").replace("%s",e.length);if(e.length){for(var n="",i=0;i<e.length;i++)n+=ae(e[i]);return n}return t.language.phrase("PleaseSelect")}function ie(n,i,r){var o,l=s[r.id],d=Z(n),c=Z(n,!1),u=i.lf,p={lf:i.lf,df1:i.df,df2:i.df2,df3:i.df3,df4:i.df4};o=l.lists(c).template&&!k(n)?l.lists(c).template.render(p,t.jsRenderHelpers):te(i,n)||u;var f={data:p,name:d,form:r.$element,value:u,text:o};if(n.options)t.extend(f,{option:e("<option></option>").val(f.value).html(f.text)}),a.trigger("newoption",[f]),e(n).append(f.option);else if(n.length){var h=Q(n),g=h.data("options");h[0]&&g&&g.push({val:f.value,lbl:f.text})}else if(k(n)){R(n)._options.push({val:f.value,lbl:f.text})}else if(P(n)){var m=e(n);(g=m.data("options")||[]).push({val:f.value,lbl:f.text}),m.data("options",g)}return f.text}function re(n){var i=Z(n),r=E(n),o=Q(n);if(o[0]&&o.data("options")){var s=o.parent().find("#tp_"+i);if(s[0]){var l=t.IS_MOBILE?1:parseInt(o.data("repeatcolumn"),10)||5,d=s.contents(),c=o.data("options"),u=d.attr("type"),p=o.prevAll(".dropdown-toggle"),f=o.closest(".ew-dropdown-list").find(".ew-dropdown-clear");if(c&&c.length){if(l>1||"checkbox"==u||!p[0]){var h=e('<div class="d-table ew-item-table"></div>');"checkbox"==u&&h.click(function(e){e.stopPropagation()});for(var g=0,m=c.length;g<m;g++){var v;g%l==0&&(v=e('<div class="d-table-row"></div>')),(y=d.clone(!0).val(c[g].val).click(function(t){if(p[0]){var a=h.find("input[name='"+this.name+"']:checked").map(function(){return e(this).parent().text()});p.html(ne(a.get(),e(this).data("maxcount"))),f.prop("disabled",0==a.length)}})).attr("id",y.attr("id")+"_"+g+"_"+Me());var w=e('<label class="custom-control-label"></label>').attr("for",y.attr("id")).append(c[g].lbl),b={name:i,form:r,value:c[g].val,text:c[g].lbl,option:e('<div class="custom-control custom-'+u+'"></div>').append(y.add(w))};if(a.trigger("newoption",[b]),e('<div class="d-table-cell"></div>').append(b.option).appendTo(v),g%l==l-1)h.append(v);else if(g==m-1){for(var x=g%l+1;x<l;x++)v.append('<div class="d-table-cell"></div>');h.append(v)}}o.find("div").first().append(h)}else{var _=e('<div class="list-group"></div>');for(g=0,m=c.length;g<m;g++){var y;(y=d.clone(!0).val(c[g].val).click(function(a){var n=e(this).closest(".list-group-item");n.hasClass("active")&&(this.checked=!1),n.siblings(".list-group-item").removeClass("active"),n.toggleClass("active",this.checked),p.html(this.checked?n.text():t.language.phrase("PleaseSelect")),f.prop("disabled",!this.checked)})).attr("id",y.attr("id")+"_"+g+"_"+Me());w=e('<label class="custom-control-label"></label>').attr("for",y.attr("id")).append(c[g].lbl);var S=e('<a class="list-group-item list-group-item-action" href="#"></a>').append(y,w);b={name:i,form:r,value:c[g].val,text:c[g].lbl,option:S};a.trigger("newoption",[b]),_.append(b.option)}o.find("div").first().append(_)}f.prop("disabled",p&&(p.html()||"").trim()==t.language.phrase("PleaseSelect")).off().click(function(e){o.find("[data-field][type=radio], [data-field][type=checkbox]").prop("checked",!1).first().triggerHandler("click"),o.find(".list-group-item.active").removeClass("active"),p.html(t.language.phrase("PleaseSelect"))})}o.hasClass("dropdown-menu")||o.removeClass("d-none"),o.data("options",[])}}}function oe(a,n){if(a&&n){var i=e(a);if(e.isArray(n))if(a.options)e(a).val(n),"select-one"==a.type&&-1==a.selectedIndex&&(a.selectedIndex=0);else if(a.length)1==a.length&&"checkbox"==a[0].type&&"{value}"!=a[0].value?a[0].checked=A(a[0].value)===A(n[0]):i.val(n).closest(".ew-dropdown-list").find(".ew-dropdown-clear").prop("disabled",!1);else if(k(a)&&1==n.length){for(var r=0,o=(c=(m=R(a))._options||[]).length;r<o;r++)if(c[r].val==n[0]){a.value=c[r].val,m.input.value=c[r].lbl;break}}else if(P(a)){for(var l=[],d=[],c=(i=e(a)).data("options")||[],u=0,p=n.length;u<p;u++)for(r=0,o=c.length;r<o;r++)if(n[u]==c[r].val){l.push(c[r].val),d.push(ae(c[r].lbl));break}i.val(l.join(t.MULTIPLE_OPTION_SEPARATOR)),i.parent().find(".ew-lookup-text").html(ne(d,i.data("maxcount")))}else a.type&&(a.value=n.join(t.MULTIPLE_OPTION_SEPARATOR));if(a.options)"select-one"==a.type&&2==a.options.length&&!a.options[1].selected&&v(a)?a.options[1].selected=!0:"select-multiple"==a.type&&1==a.options.length&&!a.options[0].selected&&v(a)&&(a.options[0].selected=!0);else if(a.length){2==a.length&&v(a[1])&&(a[1].checked=!0),"radio"==a[0].type&&i.filter(":checked").closest(".list-group-item").addClass("active");var f=i.closest(".dropdown-menu"),h=f.closest(".ew-dropdown-list").find(".dropdown-toggle");if(h[0]){var g=f.find("input[name='"+a[0].name+"']:checked").map(function(){return e(this).parent().text()});h.html(ne(g.get(),i.data("maxcount")))}}else if(k(a)){var m;1==(c=(m=R(a))._options||[]).length&&v(a)&&(a.value=c[0].val,m.input.value=c[0].lbl)}}function v(t){if(!e(t).data("autoselect"))return!1;var a=E(t);if(a){if(/s(ea)?rch$/.test(a.id))return!1;var n=s[a.id].lists(t.id);return!n||0!=n.parentFields.length}return!1}}function se(){e("form.ew-form.ew-wait").removeClass("ew-wait").each(function(){var e=s[this.id];e&&(e.multiPage&&e.multiPage.lastPageSubmit||e.enableForm())}),o(),a.data("_ajax",!1)}function le(a){var i,r,o=this,s=a.id,l=a.form,d=a.forceSelect,u=/^[xy](\d*|\$rowindex\$)_/,p=s.match(u),f=s.replace(u,"x_"),h=p?p[1]:"",g={typeahead:{}};if("$rowindex$"==h)return g;var m=l.getElement(),v=l.getElement("sv_"+s);if(!v)return g;l.getElement("sc_"+s);for(var w,b=l.lists[f].parentFields.slice(),x=0,_=b.length;x<_;x++){1==b[x].split(" ").length&&(b[x]=b[x].replace(/^x_/,"x"+h+"_"))}this.data=a.data,this.minWidth=a.minWidth,this.maxHeight=a.maxHeight,this.highlight=a.highlight,this.hint=a.hint,this.minLength=a.minLength,this.limit=a.limit,this.templates=t.extend({},a.templates),this.trigger=a.trigger,this.delay=a.delay,this.display=a.display||"value",this.input=v,this.element=l.getElement(s),this.$input=i=e(this.input),this.$element=r=e(this.element),this._options=[],this._recordCount=0,i.val()&&r.val()&&this._options.push({val:r.val(),lbl:i.val()}),this.formatResult=function(e){return te(e,this.element)||e[0]},this.setValue=function(a){a=a||i.val();var n=i.data("results")?e.map(i.data("results"),function(e,t){if(e.value==a)return t}):[];if(0==n.length){if(this._options&&this._options.length&&this._options[this._options.length-1].lbl==a)return;if(d&&a)return i.typeahead("val","").attr("placeholder",t.language.phrase("ValueNotExist")).addClass("is-invalid"),void r.val("").change()}else if(!/s(ea)?rch$/.test(m.id)||d){var o=n[0];o>-1&&(a=i.data("results")[o].lf)}a!==r.val()&&r.val(a).change()},this.generateRequest=function(){var e=t.extend({},this.data,{name:this.element.name,ajax:"autosuggest"},O("#p_"+s,m));if(b.length>0)for(var a=0,n=b.length;a<n;a++){var i=J(b[a],m);e["v"+(a+1)]=i.join(t.MULTIPLE_OPTION_SEPARATOR)}return e},this.prepare=function(a,n){var i={};i.data=this.generateRequest(),i.type="POST",i.dataType="json";var r=new URLSearchParams({q:a,n:this.limit,rnd:Me()});return e.isNumber(n)&&r.set("start",n),i.url=c(t.API_LOOKUP_ACTION,r.toString()),i},this.transform=function(t){var a;return t&&"OK"==t.result&&(o._recordCount=t.totalRecordCount,a=t.records),i.data("results",a||[]),e.map(i.data("results"),function(e){var t=e.value=o.formatResult(e);return{lf:e[0],df1:e[1],df2:e[2],df3:e[3],df4:e[4],value:t}})},this.source=function(t,a,n){o._recordCount=0;var i=o.prepare(t);e.ajax(i).done(function(e){n(o.transform(e))})},this.count=function(){return o.typeahead.menu.$node.find(".tt-suggestion.tt-selectable").length},this.more=function(){n.css("cursor","wait");var t=o.typeahead,a=t.menu.query,i=t.menu.datasets[0],r=o.count(),s=o.prepare(a,r);e.ajax(s).done(function(e){e=o.transform(e),i._append(a,e),t.menu.$node.find(".tt-dataset").scrollTop(i.$lastSuggestion.outerHeight()*r)}).always(function(){n.css("cursor","default")})},i.on("typeahead:select",function(e,t){o.setValue(t.value)}).change(function(e){var t=i.data("tt-typeahead");if(t&&t.isOpen()&&!t.menu.empty()){var a=t.menu.getActiveSelectable();if(a){var n=a.index(),r=i.data("results")[n][1];i.typeahead("val",r)}}o.setValue()}).blur(function(e){var t=i.data("tt-typeahead");t&&t.isOpen()&&t.menu.close()}).focus(function(e){i.attr("placeholder",i.data("placeholder")).removeClass("is-invalid")}),(w=l.lists[f].template?l.lists[f].template:o.templates.suggestion)&&e.isString(w)&&(w=e.templates(w)),w&&(o.templates.suggestion=w.render.bind(w)),r.data("autosuggest",this),e(function(){var e={highlight:o.highlight,minLength:o.minLength,hint:o.hint,trigger:o.trigger,delay:o.delay},a={name:l.id+"-"+s,source:o.source,templates:o.templates,display:o.display,limit:o.limit,async:!0},n=[e,a];r.trigger("typeahead",[n]),o.limit=a.limit,i.typeahead.apply(i,n),i.on("typeahead:rendered",function(){var a=o.typeahead.menu.$node.find(".tt-more").html(t.language.phrase("More"));arguments.length>1&&o._recordCount>o.count()?a.one(e.trigger,function(t){setTimeout(function(){o.more()},e.delay),t.preventDefault(),t.stopPropagation()}):a.hide()}),i.off("blur.tt"),o.typeahead=i.data("tt-typeahead");var d=o.typeahead.menu.$node.css("z-index",1e3);o.minWidth&&d.css("min-width",o.minWidth);var c=d.find(".tt-dataset"),u=o.maxHeight||(parseInt(c.css("line-height"),10)+6)*(a.limit+1);c.css({"max-height":u,"overflow-y":"auto"})})}function de(e,t){var a,n=0,i=/<script([^>]*)>([\s\S]*?)<\/script\s*>/gi;for(e=e.replace(/<head>[\s\S]*<\/head>/,"");null!=(a=i.exec(e));){var r=a[2];/(\s+type\s*=\s*['"]*text\/javascript['"]*)|^((?!\s+type\s*=).)*$/i.test(a[1])&&r&&ue(r,"scr_"+t+"_"+n++)}}function ce(e){for(var t,a=/<script([^>]*)>([\s\S]*?)<\/script\s*>/gi,n=e;null!=(t=a.exec(e));){var i=t[0];/(\s+type\s*=\s*['"]*text\/javascript['"]*)|^((?!\s+type\s*=).)*$/i.test(t[1])&&(n=n.replace(i,""))}return n}function ue(e,t){var a=document.createElement("SCRIPT");return t&&(a.id=t),a.text=e,document.body.appendChild(a)}function pe(t){t&&e("script[id^='scr_"+t+"_']").remove()}function fe(t){var a=ce(t).match(/<body[\s\S]*>[\s\S]*<\/body>/i);return e(a[0]).not("div[id^=ew].modal, #ew-tooltip, #cookie-consent")}function he(e){return e.options?Array.prototype.map.call(e.options,function(e){return{value:e.value,name:e.text}}):e.length&&Q(e).data("options")||[]}function ge(t){var a=e(this),n=a.data("args");pe("ModalDialog");var i=a.removeData("args").find(".modal-body form").data("form");i&&i.destroyEditor();var r=a.find(".modal-body").html("");r.ewjtable&&r.ewjtable("instance")&&r.ewjtable("destroy"),a.find(".modal-footer .btn-primary").unbind(),a.find(".modal-dialog").removeClass(function(e,t){var a=t.match(/table\-\w+/);return a?a[0]:""}),a.data("showing",!1),a.data("url",null),n&&n.reload&&window.location.reload(!0)}function me(a){var n=s(a).$element[0];if(n){var i=J(a),r=Z(a),o=r.match(/^([xy])(\d*)_/),l=(o&&o[1],o?o[2]:""),d=r.replace(/^([xy])(\d*)_/,"x_"),u=s(a).lists[d],p=u.autoFillTargetFields,f=function(t){for(var i=t&&t.records||"",o=i?i[0]:[],d=0;d<p.length;d++){var c=G(p[d].replace(/^x_/,"x"+l+"_"),n);if(c){var u=e.isValue(o["af"+d])?o["af"+d]:"",f={results:i,result:o,data:u,form:n,name:r,target:p[d],cancel:!1,trigger:!0};if(e(a).trigger("autofill",[f]),f.cancel)continue;u=f.data,c.options||c.length&&"radio"==c[0].type?oe(c,u.split(",")):c.length&&"checkbox"==c[0].type?oe(c,u.split(",")):k(c)?(c.value=u,R(c).input.value=u,S.call(s[n.id],c)):P(c)?(c.value=u,S.call(s[n.id],c)):C(c)?(c.value=u,e(c).data("editor").set()):c.value=u,f.trigger&&e(c).change()}}return o};if(i.length>0&&""!=i[0]){var h=t.extend({page:u.page,field:u.field,ajax:"autofill",v0:i[0],language:t.LANGUAGE_ID},O("#p_"+r,n)),g=u.parentFields.slice();if(""!=l)for(var m=0,v=g.length;m<v;m++){1==(i=g[m].split(" ")).length&&(g[m]=g[m].replace(/^x_/,"x"+l+"_"))}for(var w=g.map(function(e){return J(e,n)}),b=(m=0,w.length);m<b;m++)h["v"+(m+1)]=w[m].join(t.MULTIPLE_OPTION_SEPARATOR);return e.post(c(t.API_LOOKUP_ACTION),h,f,"json")}return f()}}function ve(a,n){var i=e(n),r=e("#"+i.data("tooltip-id")),o=i.data("trigger")||"hover",s=i.data("placement")||(t.CSS_FLIP?"left":"right");r[0]&&(""!=r.text().trim()||r.find("img[src!='']")[0])&&(i.data("bs.popover")||i.popover({html:!0,placement:s,trigger:o,delay:100,container:e("#ew-tooltip")[0],content:r.html(),sanitizeFn:t.sanitizeFn}).on("show.bs.popover",function(t){var a,n=e(i.data("bs.popover").getTipElement()).css("z-index",9999);(a=i.data("tooltip-width"))&&n.css("max-width",parseInt(a,10)+"px")}))}function we(){return location.href.split("#")[0].split("?")[0]}function be(e){return Te(e,"us",t.DATE_SEPARATOR)}function xe(e){return Te(e,"usshort",t.DATE_SEPARATOR)}function _e(e){return Te(e,"std",t.DATE_SEPARATOR)}function Ee(e){return Te(e,"stdshort",t.DATE_SEPARATOR)}function ye(e){return Te(e,"euro",t.DATE_SEPARATOR)}function Se(e){return Te(e,"euroshort",t.DATE_SEPARATOR)}function Te(e,t,a){if(!e||""==e.length)return!0;var n=(e=e.replace(/ +/g," ").trim()).split(" ");if(n.length>0){var i,r,o,s,l;if(r=(i=/^(\d{4})-([0][1-9]|[1][0-2])-([0][1-9]|[1|2]\d|[3][0|1])$/).exec(n[0]))o=r[1],s=r[2],l=r[3];else{var d=Pe(a);switch(t){case"std":i=new RegExp("^(\\d{4})"+d+"([0]?[1-9]|[1][0-2])"+d+"([0]?[1-9]|[1|2]\\d|[3][0|1])$");break;case"stdshort":i=new RegExp("^(\\d{2})"+d+"([0]?[1-9]|[1][0-2])"+d+"([0]?[1-9]|[1|2]\\d|[3][0|1])$");break;case"us":i=new RegExp("^([0]?[1-9]|[1][0-2])"+d+"([0]?[1-9]|[1|2]\\d|[3][0|1])"+d+"(\\d{4})$");break;case"usshort":i=new RegExp("^([0]?[1-9]|[1][0-2])"+d+"([0]?[1-9]|[1|2]\\d|[3][0|1])"+d+"(\\d{2})$");break;case"euro":i=new RegExp("^([0]?[1-9]|[1|2]\\d|[3][0|1])"+d+"([0]?[1-9]|[1][0-2])"+d+"(\\d{4})$");break;case"euroshort":i=new RegExp("^([0]?[1-9]|[1|2]\\d|[3][0|1])"+d+"([0]?[1-9]|[1][0-2])"+d+"(\\d{2})$")}if(!i.test(n[0]))return!1;var c=n[0].split(a);switch(t){case"std":case"stdshort":o=Oe(c[0]),s=c[1],l=c[2];break;case"us":case"usshort":o=Oe(c[2]),s=c[0],l=c[1];break;case"euro":case"euroshort":o=Oe(c[2]),s=c[1],l=c[0]}}if(!Ae(o,s,l))return!1}return!(n.length>1&&!Re(n[1]))}function Oe(e){return 2==e.length?e>t.UNFORMAT_YEAR?"19"+e:"20"+e:e}function Ae(e,t,a){e=parseInt(e,10),t=parseInt(t,10),a=parseInt(a,10);var n=[4,6,9,11].includes(t)?30:31;return 2==t&&(n=e%4>0||e%100==0&&e%400>0?28:29),ke(a,1,n)}function Ie(e){if(!(e=String(e))||0==e.length)return!0;e=e.trim();var a=Pe(t.THOUSANDS_SEP),n=Pe(t.DECIMAL_POINT);return new RegExp("^[+-]?(\\d{1,3}("+(a?a+"?":"")+"\\d{3})*("+n+"\\d+)?|"+n+"\\d+)$").test(e)}function Ce(e){if(e=String(e),""!=t.THOUSANDS_SEP){var a=new RegExp(Pe(t.THOUSANDS_SEP),"g");e=e.replace(a,"")}return""!=t.DECIMAL_POINT&&(e=e.replace(t.DECIMAL_POINT,".")),parseFloat(e)}function Pe(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function ke(t,a,n){return!t||0==t.length||((e.isNumber(a)||e.isNumber(n))&&Ie(t)&&(t=Ce(t)),!(!e.isNull(a)&&t<a)&&!(!e.isNull(n)&&t>n))}function Re(e){return!e||0==e.length||(e=e.trim(),new RegExp("^(0\\d|1\\d|2[0-3])"+Pe(t.TIME_SEPARATOR)+"[0-5]\\d(( ("+Pe(t.language.phrase("AM"))+"|"+Pe(t.language.phrase("PM"))+"))|("+Pe(t.TIME_SEPARATOR)+"[0-5]\\d(\\.\\d+)?)?)$","i").test(e))}function Ne(e,t){if(!e||0==e.length)return!0;for(var a=e.replace(/,/g,";").split(";"),n=0,i=a.length;n<i;n++){if(t>0&&i>t)return!1;if(!De(a[n]))return!1}return!0}function De(e){return!e||0==e.length||/^[\w.%+-]+@[\w.-]+\.[A-Z]{2,18}$/i.test(e.trim())}function Le(a){if(window.location!=window.parent.location&&parent.showMessage)return parent.showMessage(a);var i=a&&a.target?a.target:document,r=e(i).find("div.ew-message-dialog:hidden:first"),o=e.isString(a)?a.replace(/<[^>]*>/g,""):r.length?r.text():"";if(""!=o.trim())if(r.length)["success","info","warning","danger"].forEach(function(a,i){var o=r.find(".alert-"+a).toggleClass("alert-"+a),s=o.find(".alert-heading").detach(),l=o.children(":not(.icon)");if(o.find(".icon").remove(),o[0])if(t.IS_MOBILE)alert(o.text());else{var d=e(t.toastTemplate),c=d.find(".toast-header").addClass("bg-"+a);s[0]?c.find("strong").html(s.html()):c.find("strong").html(t.language.phrase(a));var u=parseInt(l.css("width"),10);u>0&&(l.first().css("width","auto"),d.css("max-width",u));var p=o.html();d.find(".toast-body").html(p);var f={animation:!0,autohide:"success"==a&&t.autoHideSuccessMessage,delay:"success"==a?t.autoHideSuccessMessageDelay:500};e("#toast-container")[0]||n.append('<div id="toast-container"></div>');var h=e("#toast-container").append(d);d.toast(f).toast("show").on("hidden.bs.toast",function(){h[0]&&!h.find(".toast.show")[0]&&h.remove()})}});else if(t.IS_MOBILE)alert(o);else{var s=e("#ew-message-box");s.find(".modal-body").html(o),s.modal("show")}}function Me(){return Math.floor(100001*Math.random())+1e5}function Fe(a){var n=e(a);if(!n.data("blueimpFileupload")){var i=n.attr("name"),r=i.replace(/\$/g,"\\$"),o=n.data("table"),s=n.is("[multiple]"),l=n.closest(".form-group, [id^='el']"),d=n.prop("disabled")||"F"==n.closest("form").find("#confirm").val(),u=l.find("#ft_"+r),p=l.find("#fn_"+r),f=l.find("#fa_"+r),h=l.find("#fs_"+r),g=l.find("#fx_"+r),w=l.find("#fm_"+r),b=l.find("#fc_"+r),x=l.find(".custom-file-label"),_=x.html(),y=function(e){!s&&p.val()&&(confirm(t.language.phrase("UploadOverwrite"))||(e.preventDefault(),e.stopPropagation()))},S=e.templates("#template-download"),T=e.templates("#template-upload"),O=E(a),A=e(O);(d="F"==A.find("#confirm").val())&&A.find("span.fileinput-button").hide();var I=parseInt(b.val(),10),C=c(t.API_JQUERY_UPLOAD_ACTION),P={id:i,table:o,session:t.SESSION_ID,replace:s?"0":"1",exts:g.val(),maxsize:w.val(),maxfilecount:b.val()};n.fileupload({url:C,type:"POST",multipart:!0,autoUpload:!0,loadImageFileTypes:/^image\/(gif|jpe?g|png)$/i,loadVideoFileTypes:/^video\/mp4$/i,loadAudioFileTypes:/^audio\/(mpeg|mp3)$/i,acceptFileTypes:g.val()?new RegExp("\\.("+g.val().replace(/,/g,"|")+")$","i"):null,maxFileSize:parseInt(w.val(),10),maxNumberOfFiles:I>1?I:null,filesContainer:u,formData:P,uploadTemplateId:null,downloadTemplateId:null,uploadTemplate:T.render.bind(T),downloadTemplate:S.render.bind(S),previewMaxWidth:t.UPLOAD_THUMBNAIL_WIDTH,previewMaxHeight:t.UPLOAD_THUMBNAIL_HEIGHT,dropZone:l,pasteZone:l,messages:{acceptFileTypes:t.language.phrase("UploadErrMsgAcceptFileTypes"),maxFileSize:t.language.phrase("UploadErrMsgMaxFileSize"),maxNumberOfFiles:t.language.phrase("UploadErrMsgMaxNumberOfFiles"),minFileSize:t.language.phrase("UploadErrMsgMinFileSize")},readOnly:d}).on("fileuploaddone",function(e,a){if(!a.result.files[0].error){var n=a.result.files[0].name,i=s&&p.val()?p.val().split(t.MULTIPLE_UPLOAD_SEPARATOR):[];i.push(n),p.val(i.join(t.MULTIPLE_UPLOAD_SEPARATOR)),f.val("0"),s||u.find("tr:not(:last)").remove()}}).on("fileuploaddestroy",function(a,n){var i=e(a.originalEvent.target).data("url"),r=new URLSearchParams(i.split("?")[1]),o=r.get("id"),s=r.get(o);if(s){var l=p.val()?p.val().split(t.MULTIPLE_UPLOAD_SEPARATOR):[],d=l.indexOf(s);d>-1&&l.splice(d,1),p.val(l.join(t.MULTIPLE_UPLOAD_SEPARATOR)),f.val("0")}}).on("fileuploadchange",function(a,n){for(var i=p.val()?p.val().split(t.MULTIPLE_UPLOAD_SEPARATOR):[],r=0;r<n.files.length;r++)i.push(n.files[r].name);var o=parseInt(b.val(),10);if(e.isNumber(o)&&o>0&&i.length>o)return N(t.language.phrase("UploadErrMsgMaxNumberOfFiles")),!1;var s=parseInt(h.val(),10);return e.isNumber(s)&&s>0&&i.join(t.MULTIPLE_UPLOAD_SEPARATOR).length>s?(N(t.language.phrase("UploadErrMsgMaxFileLength")),!1):void 0}).on("fileuploadadded fileuploadfinished fileuploaddestroyed",function(){u.css("margin-top",u.find("tr")[0]&&!d?"10px":"0");var e=p.val()?p.val().split(t.MULTIPLE_UPLOAD_SEPARATOR):[];x.html(e.join(", ")||_)}).on("fileuploadprocessfail",function(e,t){t.files&&t.files.error&&N(t.files[0].error)}).on("fileuploadadded",function(e,t){t.context.find(".start").click(y)}).on("fileuploadcompleted",function(e,t){m(e={target:t.context}),v(e)}).click(function(){n.closest("span.fileinput-button").tooltip("hide")}),p.val()&&e.ajax({url:C,data:{id:i,table:o,session:t.SESSION_ID},dataType:"json",context:this,success:function(t){if(t&&t[i]){var r=n.fileupload("option","done");r&&r.call(a,e.Event(),{result:{files:t[i]}})}d&&u.find("td.delete").hide()}})}}function $e(a){var n=a&&a.target?a.target:document,r=e(n),o=r.find("table.ew-table:not(.ew-export-table)");Array.prototype.forEach.call(n.querySelectorAll(".ew-grid-upper-panel, .ew-grid-lower-panel"),t.initGridPanel),t.renderJsTemplates(a),function(t){var a=t&&t.target?t.target:document,n=e(a);for(var i in s)n.find("#"+i)&&s[i].init()}(a),w(a),d(a),l(a),m(a),v(a),r.find("[data-widget='treeview']").each(function(){adminlte.Treeview._jQueryInterface.call(e(this),"init")}),o.each(B),r.find(".ew-btn-dropdown").on("shown.bs.dropdown",function(){var t=e(this).removeClass("dropup"),a=e(window);$menu=t.find("> .dropdown-menu"),t.toggleClass("dropup",$menu.offset().top+$menu.height()>a.scrollTop()+a.height())}),r.find("input[name=pageno]").keypress(function(e){if(13==e.which)return i.searchParams.append(this.name,parseInt(this.value)),window.location=i.toString(),!1}),t.IS_SCREEN_SM_MIN||r.find("."+t.RESPONSIVE_TABLE_CLASS+" [data-toggle='dropdown']").parent().on("shown.bs.dropdown",function(){var a=e(this),n=a.find(".dropdown-menu"),i=a.closest("."+t.RESPONSIVE_TABLE_CLASS)[0];if(i.scrollHeight-i.clientHeight){var r=n.offset().top+n.outerHeight()-e(i).offset().top-i.clientHeight;r>0&&n.css(t.CSS_FLIP?"right":"left","100%").css("top",parseFloat(n.css("top"))-r)}}),g(a),p(a),f(a);var c=r.find(".ew-report");c[0]&&(c.find(".card").on("collapsed.lte.widget",function(){var t=e(this).closest("[class^='col-']"),a=t.css("min-height");a&&t.data("min-height",a),t.css("min-height",0)}).on("expanded.lte.widget",function(){var t=e(this).closest("[class^='col-']"),a=t.css("min-height");a&&t.css("min-height",a)}),c.find("span.ew-group-toggle").on("click",function(){t.toggleGroup(this)})),void 0!==t.USE_JAVASCRIPT_MESSAGE&&t.USE_JAVASCRIPT_MESSAGE&&Le(a)}a.ajaxSend(function(e,a,n){var o=n.url;o.match(/\w+preview(\w+)?(\.php)?\?/i)&&r();var s=c(),l=o.startsWith(s),d=l||o.startsWith(we());!d&&o.match(/^http/i)&&(d=new URL(o).hostname==i.hostname);if(d)if(l&&t.API_JWT_TOKEN&&!t.IS_WINDOWS_AUTHENTICATION&&a.setRequestHeader(t.API_JWT_AUTHORIZATION_HEADER,"Bearer "+t.API_JWT_TOKEN),"GET"==n.type){var u=n.url.split("?");(p=new URLSearchParams(u[1])).set(t.TOKEN_NAME,t.ANTIFORGERY_TOKEN),u[1]=p.toString(),n.url=u[0]+(u[1]?"?"+u[1]:"")}else{var p;if(n.data instanceof FormData)n.data.set(t.TOKEN_NAME,t.ANTIFORGERY_TOKEN);else(p=new URLSearchParams(n.data)).set(t.TOKEN_NAME,t.ANTIFORGERY_TOKEN),n.data=p.toString()}}),a.ajaxStart(function(){a.data("_ajax",!0),t.addSpinner(),e("form.ew-form").addClass("ew-wait").each(function(){var e=s[this.id];e&&(e.multiPage&&e.multiPage.lastPageSubmit||e.disableForm())})}),a.ajaxStop(se).ajaxError(se),e(window).off("load.lte.treeview");var je,Ue=adminlte.Layout,He=adminlte.Treeview;return He.prototype._toggle=He.prototype.toggle,He.prototype.toggle=function(t){var a=e(t.currentTarget),n=a.next(),i=a.attr("href"),r=e(t.target).closest(".menu-item-text");!n.is(".nav-treeview")||r[0]&&i&&"#"!=i&&"javascript:void(0);"!=i||this._toggle(t)},loadjs.ready("load",function(){e.views.settings.debugMode(t.DEBUG),u(),$e(),e("#ew-modal-dialog").on("load.ew",$e),e("#ew-add-opt-dialog").on("load.ew",$e);var n=i.searchParams.get("hash");n&&e("html, body").animate({scrollTop:e("#"+n).offset().top},800),o(),a.trigger("load")}),a.on("addoption",function(t,a){for(var n=a.data,i=a.parents,r=0,o=i.length;r<o;r++){var s=i[r];if(!s.length)return a.valid=!1;var l=n["ff"+(r>0?r+1:"")];if(!e.isUndefined(l)&&!s.includes(String(l)))return a.valid=!1}}),a.on("show.bs.modal",".modal",function(){var t=1040+e(".modal:visible").length;e(this).css("z-index",t),setTimeout(function(){e(".modal-backdrop").not(".modal-stack").css("z-index",t-1).addClass("modal-stack")},0)}),a.on("hidden.bs.modal",".modal",function(){e(".modal:visible").length&&n.addClass("modal-open")}),{currentUrl:i,removeSpinner:o,forms:s,searchOperatorChanged:function(t){var a=e(t).closest("[id^=r_], [id^=xsc_]"),n=t.id.substr(2),i=a.find(".ew-search-field"),r=(i.find("[name='x_"+n+"'], [name='x_"+n+"[]']"),a.find(".ew-search-field2")),o=r.find("[name='y_"+n+"'], [name='y_"+n+"[]']").length,s=a.find(".ew-search-cond"),l=s.length,d=a.find(".ew-search-and"),c=a.find(".ew-search-operator").find("[name='z_"+n+"']").val(),u=a.find(".ew-search-operator2"),p=u.find("[name='w_"+n+"']").val(),f="BETWEEN"==c,h=["IS NULL","IS NOT NULL"].includes(c),g=["IS NULL","IS NOT NULL"].includes(p),m=!o||f,v=h,w=!f&&(!l||g);s.toggleClass("d-none",m).find(":input").prop("disabled",m),d.toggleClass("d-none",!f),u.toggleClass("d-none",m).find(":input").prop("disabled",m),i.toggleClass("d-none",v).find(":input").prop("disabled",v),r.toggleClass("d-none",w).find(":input").prop("disabled",w)},initIcons:l,initPasswordOptions:d,getApiUrl:c,setSessionTimer:u,initExportLinks:p,initMultiSelectCheckboxes:f,fileDownload:h,lazyLoad:g,initLightboxes:m,initPdfObjects:v,initTooltips:w,Form:x,prompt:_,getForm:E,hasFormData:y,setSearchType:function(a,n){var i=e(a),r=i.closest("form"),o="";return r.find("input[name=psearchtype]").val(n||""),o="="==n?t.language.phrase("QuickSearchExactShort"):"AND"==n?t.language.phrase("QuickSearchAllShort"):"OR"==n?t.language.phrase("QuickSearchAnyShort"):t.language.phrase("QuickSearchAutoShort"),r.find("#searchtype").html(o+(o?"&nbsp;":"")),i.closest("ul").find("li").removeClass("active"),i.closest("li").addClass("active"),!1},updateOptions:S,getUserParams:O,applyTemplate:function(n,r,o,s,l){var d,c={data:l||{},id:n,template:r,class:o,export:s,enabled:!0};e.views&&r&&(d=e("#"+r))[0]&&(d.attr("type")||d.attr("type","text/html"),a.trigger("rendertemplate",[c]),c.enabled&&e("#"+n).html(d.render(c.data,t.jsRenderHelpers))),s&&"print"!=s&&e(function(){var a=e("meta[http-equiv='Content-Type']"),r="<html><head>",o=e("#"+n);o.children(0).is("div[id^=ct_]")&&(o=o.children(0)),a[0]&&(r+="<meta http-equiv='Content-Type' content='"+a.attr("content")+"'>"),r+="pdf"==s?"<link rel='stylesheet' type='text/css' href='"+t.PDF_STYLESHEET_FILENAME+"'>":"<style>"+e.ajax({async:!1,type:"GET",url:t.PROJECT_STYLESHEET_FILENAME}).responseText+"</style>",r+="</head><body>",e(".ew-chart-top").each(function(){r+=e(this).html()}),r+=o.html(),e(".ew-chart-bottom").each(function(){r+=e(this).html()}),r+="</body></html>";var l=we(),d={customexport:s,data:r,filename:c.class};if(d[t.TOKEN_NAME]=t.ANTIFORGERY_TOKEN,"email"==s){var u=i.searchParams.toString()+"&"+e.param(d);e.post(l,u,function(e){Le(e)})}else h(l,d);window.location!=window.parent.location&&window.parent.jQuery&&window.parent.jQuery("body").css("cursor","default")})},showTemplates:function(t){e("script"+(t?"."+t:"")+"[type='text/html']").each(function(){var t=e(this),a=t.html().match(/^\s*(<(td|th)[\s\S]*>[\s\S]*<\/\2>)\s*$/i);a?t.next().before(a[1]):e(this).after(e("<span></span>").addClass(t.attr("class")).html(t.html())),t.closest(".ew-table, .ew-view-table, .ew-grid").removeClass("d-none").show()})},convertToBool:A,valueChanged:function(t,a,n,i){var r=G("x"+a+"_"+n,t),o=W("o"+a+"_"+n,t),s=W("fn_x"+a+"_"+n,t);if(!o&&(!r||e.isArray(r)&&0==r.length))return!1;var l=function(e){return J(e).join()};if(o&&r)if(i){if(A(l(o))===A(l(r)))return!1}else if(l(o)==l(s||r))return!1;return!0},setLanguage:function(a){var n=e(a),r=n.val()||n.data("language");if(r){var o=new URLSearchParams;i.searchParams.forEach(function(e,a){o.append(a,t.sanitize(e))}),o.set("language",t.sanitize(r)),i.search=o.toString(),window.location=i.toString()}},submitAction:function(a,n){var i=a.target||a.srcElement,r=e(i),o=n.f||r.closest("form")[0]||currentForm,s=e(o),l=n.key,d=n.action,c=n.url||we(),u=n.msg,p=n.data,f=n.success,h=!n.method||V(n.method[0],"p"),g=!n.select&&!n.key||n.select&&V(n.select[0],"m");if(g&&!s[0])return!1;if(g&&!F(s[0]))return _('<p class="text-danger">'+t.language.phrase("NoRecordSelected")+"</p>"),!1;var m=function(e){Le(e)},v=function(){if(h){if(d&&e("<input>").attr({type:"hidden",name:"useraction",value:d}).appendTo(s),e.isObject(p))for(var t in p){var a=s.find("input[type=hidden][name='"+t+"']");a[0]?a.val(p[t]):e("<input>").attr({type:"hidden",name:t,value:p[t]}).appendTo(s)}if(!g&&e.isObject(l))for(var t in l)e("<input>").attr({type:"hidden",name:t,value:l[t]}).appendTo(s);s.prop("action",c).submit(),d&&s.find("input[type=hidden][name=useraction]").remove()}else p=e.isObject(p)?e.param(p):e.isString(p)?p:"",d&&(p+="&useraction="+d+"&ajax="+d),g?p+="&"+s.find("input[name='key_m[]']:checked").serialize():l&&(p+="&"+(e.isObject(l)?e.param(l):l)),f&&e.isString(f)&&(f=window[f]),e.isFunction(f)?e.post(c,p,f):e.isObject(f)?(f.data=p,f.method=f.method||"POST",f.success=f.success||m,e.ajax(c,f)):e.post(c,p,m)};return u?_(u,function(e){e&&v()}):v(),!1},export:I,removeSpaces:function(e){return/^(<(p|br)\/?>(&nbsp;)?(<\/p>)?)?$/i.test(e.replace(/\s/g,""))?"":e},isHiddenTextArea:C,isModalLookup:P,isAutoSuggest:k,getAutoSuggest:R,alert:N,onError:D,setFocus:L,hasValue:M,sort:function(e,t,a){return 2==a&&e.ctrlKey&&(t+="&ctrl=1"),location=t,!0},confirmDelete:function(e){return Y(e),_(t.language.phrase("DeleteConfirmMsg"),function(t){t&&e.href?window.location=e.href:H(e)}),!1},keySelected:F,selectAllKey:function(t){$(t);var a=e(t).closest(".ew-table")[0];a&&e(a.tBodies).each(function(){e(this.rows).each(function(a,n){var i=e(n);i.is(":not(.ew-template):not(.ew-table-preview-row)")&&(i.data({selected:t.checked,checked:t.checked}),j(0,n))})})},selectAll:$,updateSelected:function(t){return e(t).find("input[type=checkbox][name^=u_]:checked,input:hidden[name^=u_][value=1]").length>0},setColor:j,clearSelected:U,clearDelete:H,clickDelete:Y,clickMultiCheckbox:function(t){var a=t.target||t.srcElement,n=e(a),i=n.closest(".ew-table")[0];if(i){U(i);var r=n.closest(".ew-table > tbody > tr");r.siblings("[data-rowindex='"+r.data("rowindex")+"']").addBack().each(function(t,n){e(n).data("checked",a.checked).data("selected",a.checked).find("input[type=checkbox][name='key_m[]']").each(function(){this!=a&&(this.checked=a.checked)}),j(0,n)}),t.stopPropagation()}},setupTable:B,setupGrid:z,addGridRow:function(a){var n=e(a).closest(".ew-grid"),i=n.find("table.ew-table").last(),r=i.parent("div"),o=i.find("tr.ew-template");if(!(a&&n[0]&&i[0]&&o[0]))return!1;var s=e(i[0].rows).last();i.find("td.ew-table-last-row").removeClass("ew-table-last-row");var l=o.clone(!0,!0).removeClass("ew-template"),d=n.find("div.ew-form[id^=f][id$=grid]");d[0]||(d=n.find("form.ew-form[id^=f][id$=list]"));var c=d.is("div")?"_"+d.attr("id"):"",u=d.find("#key_count"+c),p=parseInt(u.val(),10)+1;l.attr({id:"r"+p+l.attr("id").substring(2),"data-rowindex":p});var f=o.find("script:contains('$rowindex$')");l.children("td").each(function(){e(this).find("*").each(function(){e.each(this.attributes,function(e,t){t.value=t.value.replace(/\$rowindex\$/g,p)})})}),l.find(".ew-icon").closest("a, button").removeData("bs.tooltip").tooltip({container:"body",placement:"bottom",trigger:"hover",sanitizeFn:t.sanitizeFn}),u.val(p).after(e("<input>").attr({type:"hidden",id:"k"+p+"_action"+c,name:"k"+p+"_action"+c,value:"insert"})),s.after(l),f.each(function(){ue(this.text.replace(/\$rowindex\$/g,p))});var h=d.data("form");return h&&(h.initEditors(),h.initUpload()),B(-1,i[0],!0),r.scrollTop(r[0].scrollHeight),!1},deleteGridRow:function(a,n){var i=e(a).tooltip("hide").removeData("bs.tooltip"),r=i.closest(".ew-grid, .ew-multi-column-grid"),o=i.closest("tr, div[data-rowindex]"),s=o.closest(".ew-table");if(!a||!r[0]||!o[0])return!1;var l=parseInt(o.data("rowindex"),10),d=r.find("div.ew-form[id^=f][id$=grid]");d[0]||(d=r.find("form.ew-form[id^=f][id$=list]"));var c=d.data("form");if(!d[0]||!c)return!1;var u=d.is("div")?"_"+d.attr("id"):"",p="#key_count"+u,f=(d.find(p),function(){if(o.remove(),r.is(".ew-grid")&&B(-1,s[0],!0),l>0){var t=d.find("#k"+l+"_action"+u);t[0]?t.val("insert"==t.val()?"insertdelete":"delete"):d.find(p).after(e("<input>").attr({type:"hidden",id:"k"+l+"_action"+u,name:"k"+l+"_action"+u,value:"delete"}))}});return e.isFunction(c.emptyRow)&&c.emptyRow(n)?f():_(t.language.phrase("DeleteConfirmMsg"),function(e){e&&f()}),!1},htmlEncode:function(e){var t=String(e);return t=(t=(t=(t=t.replace(/&/g,"&amp;")).replace(/\"/g,"&quot;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")},clearForm:function(t){e(t).find("[id^=x_],[id^=y_],[id^=n_]").each(function(){"checkbox"==this.type||"radio"==this.type?this.checked=!1:"select-one"==this.type?this.selectedIndex=0:"select-multiple"==this.type?e(this).find("option").prop("selected",!1):("text"==this.type||"textarea"==this.type||"hidden"==this.type&&k(this))&&(this.value="","hidden"==this.type&&(R(this).input.value=""))})},MultiPage:function(a){var n=this;this.$form=null,this.formID=a,this.pageIndex=1,this.maxPageIndex=0,this.minPageIndex=0,this.pageIndexes=[],this.$pages=null,this.$collapses=null,this.isTab=!1,this.isCollapse=!1,this.lastPageSubmit=!1,this.hideDisabledButton=!1,this.hideInactivePages=!1,this.lockTabs=!1,this.hideTabs=!1,this.showPagerTop=!1,this.showPagerBottom=!1,this.pagerTemplate='<nav><ul class="pagination"><li class="page-item previous ew-prev"><a href="#" class="page-link"><span class="icon-prev"></span> {Prev}</a></li><li class="page-item next ew-next"><a href="#" class="page-link">{Next} <span class="icon-next"></span></a></li></ul></nav>';var i=function(e){e.preventDefault()},r=["lastPageSubmit","hideDisabledButton","hideInactivePages","lockTabs","hideTabs","showPagerTop","showPagerBottom","pagerTemplate"];this.set=function(){if(1==arguments.length&&e.isObject(arguments[0])){var t=arguments[0];for(var a in t){var n=a[0].toLowerCase()+a.substr(1);r.includes(n)&&(this[n]=t[a])}}},this.init=function(){var e=this.pagerTemplate.replace(/\{prev\}/i,t.language.phrase("Prev")).replace(/\{next\}/i,t.language.phrase("Next"));this.isTab?(this.showPagerTop&&this.$pages.closest(".tabbable, .ew-nav-tabs").before(e),this.showPagerBottom&&this.$pages.closest(".tabbable, .ew-nav-tabs").after(e),this.$form.find(".ew-prev").click(function(e){return n.$pages.off("show.bs.tab",i).filter(".active").parent().prev(":has([data-toggle=tab]:not(.ew-hidden):not(.ew-disabled))").find("[data-toggle=tab]").toggleClass("disabled d-none",!1).click(),!1}),this.$form.find(".ew-next").click(function(e){return n.$pages.off("show.bs.tab",i).filter(".active").parent().next(":has([data-toggle=tab]:not(.ew-hidden):not(.ew-disabled))").find("[data-toggle=tab]").toggleClass("disabled d-none",!1).click(),!1}),this.hideTabs&&this.$form.find(".ew-multi-page > .tabbable > .nav-tabs, .ew-multi-page > .ew-nav-tabs > .nav-tabs").hide()):this.isCollapse&&(this.showPagerTop&&this.$collapses.closest(".ew-accordion").before(e),this.showPagerBottom&&this.$collapses.closest(".ew-accordion").after(e),this.$form.find(".ew-prev").click(function(e){return n.$pages.closest(".card").filter(":has(.collapse.show)").prev(":has([data-toggle=collapse]:not(.ew-hidden):not(.ew-disabled))").toggleClass("disabled d-none",!1).find("[data-toggle=collapse]").click(),!1}),this.$form.find(".ew-next").click(function(e){return n.$pages.closest(".card").filter(":has(.collapse.show)").next(":has([data-toggle=collapse]:not(.ew-hidden):not(.ew-disabled))").toggleClass("disabled d-none",!1).find("[data-toggle=collapse]").click(),!1})),this.pageShow()},this.pageShow=function(){this.isTab?(this.lockTabs&&this.$pages.on("show.bs.tab",i),this.$pages.each(function(){var t=e(this);n.hideInactivePages&&t.toggleClass("d-none",!t.hasClass("active")),n.lockTabs&&t.toggleClass("disabled",!t.hasClass("active"))})):this.isCollapse&&this.$pages.closest(".card").each(function(){var t=e(this);n.hideInactivePages&&t.toggleClass("d-none",!t.find(".collapse.show")[0])});var t=this.lastPageSubmit&&this.pageIndex!=this.maxPageIndex,a=this.$form.closest(".content, .modal-content").find("#btn-action, button.ew-submit").prop("disabled",t).toggle(!this.hideDisabledButton||!t);e(".ew-captcha").toggle(a.is(":visible:not(:disabled)")),t=this.pageIndex<=this.minPageIndex,this.$form.find(".ew-prev").toggleClass("disabled",t),t=this.pageIndex>=this.maxPageIndex,this.$form.find(".ew-next").toggleClass("disabled",t)},this.gotoPage=this.gotoPageByIndex=function(e){if(!(e<=0||e<this.minPageIndex||e>this.maxPageIndex)&&this.pageIndex!=e){var t=this.$pages.eq(e-1);if(this.isTab)t.is(":not(.d-none):not(.disabled)")?t.click():t.parent().next(":has([data-toggle=tab]):not(.d-none):not(.disabled)").find("[data-toggle=tab]").toggleClass("disabled",!1).click();else if(this.isCollapse){var a=t.closest(".card");a.is(":not(.d-none)")?t.click():a.next(":has([data-toggle=collapse]):not(.d-none)").find("[data-toggle=collapse]").click()}this.pageIndex=e}},this.gotoPageByElement=function(t){this.gotoPage(parseInt(e(t).data("page"),10)||-1)},this.gotoPageByElementId=function(e){var t=this.$form.find("[data-page]").filter("[id='"+e+"'],[name='"+e+"'],[data-field='"+e+"']");this.gotoPageByElement(t)},this.togglePage=function(e,t){this.isTab?this.$pages.eq(e-1).toggleClass("d-none",!t):this.isCollapse&&this.$pages.eq(e-1).closest(".card").toggle("d-none",!t)},this.render=function(){this.$form=e("#"+a),this.pageIndexes=this.$form.find("[data-page]").map(function(){var t=parseInt(e(this).data("page"),10);return t>0?t:null}).get(),this.pageIndexes.sort(function(e,t){return e-t}),this.minPageIndex=this.pageIndexes[0],this.maxPageIndex=this.pageIndexes[this.pageIndexes.length-1];var i=this.$form.find("[data-toggle=tab]");if(i[0])this.$pages=i,this.isTab=!0,i.on("shown.bs.tab",function(a){n.pageIndex=i.index(a.target)+1,n.pageShow(),e(e(this).attr("href")).find(".ew-google-map").each(function(){var e=t.googleMaps[this.id];e&&e.map&&(google.maps.event.trigger(e.map,"resize"),e.map.setCenter(e.latlng))})}),this.pageIndex=i.index(i.parent(".active"))+1;else if(this.$collapses=this.$form.find("[data-toggle=collapse]"),this.$collapses[0]){this.$pages=this.$collapses,this.isCollapse=!0;var r=this.$collapses.closest(".card-header").next();r.on("shown.bs.collapse",function(a){n.pageIndex=r.index(a.target)+1,n.pageShow(),e(this).find(".ew-google-map").each(function(){var e=t.googleMaps[this.id];e&&e.map&&(google.maps.event.trigger(e.map,"resize"),e.map.setCenter(e.latlng))})}),this.pageIndex=r.index(r.hasClass("show"))+1}e(function(){n.init()})}},getElements:G,getElement:W,getAncestorBy:K,isHidden:function(t){return"none"==e(t).css("display")&&!e(t).closest(".dropdown-menu")[0]&&!P(t)&&!k(t)&&!C(t)||null!=K(t,function(t){var a=e(t);return"none"==a.css("display")&&!a.hasClass("tab-pane")&&!a.hasClass("collapse")})},sameText:V,sameString:function(e,t){return String(e)==String(t)},getOptionValues:J,getOptionTexts:X,clearOptions:q,getId:Z,valueSeparator:ee,displayValue:te,optionHtml:ae,optionsHtml:ne,newOption:ie,renderOption:re,selectOption:oe,AutoSuggest:le,executeScript:de,stripScript:ce,addScript:ue,removeScript:pe,getContent:fe,getOptions:he,addOptionDialogShow:function(n){var i=t.addOptionDialog||e("#ew-add-opt-dialog").on("hidden.bs.modal",function(){pe(i.data("args").el);var e=i.removeData("args").find(".modal-body form").data("form");e&&e.destroyEditor(),i.find(".modal-body").html(""),i.find(".modal-footer .btn-primary").unbind(),i.data("showing",!1)});if(i[0]){if(!i.data("showing")){i.data("showing",!0);var r=function(n){var r=n,o=i.data("args"),l=s(o.lnk),d=i.find(".modal-body form input[name='"+t.API_OBJECT_NAME+"']").val(),c=/^x(\d+)_/,u=(M=o.el).match(c),p=u?u[0]:"x_",f=u?u[1]:-1,h=M.replace(c,"x_");if(l.lists[h],e.isString(n)&&(r=b(n)),r&&r.success&&r[d]){var g=r[d];i.modal("hide");var m=l.$element[0],v=G(M,m);if(v){h=M.replace(c,"x_");for(var w=l.lists[h].linkField,x=l.lists[h].displayFields.slice(),_=l.lists[h].filterFields.slice(),E=l.lists[h].parentFields.slice(),y=0,S=E.length;y<S;y++)1==(N=E[y].split(" ")).length&&(E[y]=E[y].replace(/^x_/,p));var T=""!=w?g[w]:"",O={lf:T};for(y=0,S=x.length;y<S;y++)x[y]in g&&(O["df"+(y||"")]=g[x[y]]);for(y=0,S=_.length;y<S;y++)_[y]in g&&(O["ff"+(y||"")]=g[_[y]]);if(T&&x.length>0&&O.df){var A=Z(M,!1),I=A.replace(new RegExp("^"+p),"x_");null===l.lists[I].ajax&&(N=l.lists[I].options).push(O);var C=[];for(y=0,S=E.length;y<S;y++)C.push(J(E[y],m));if(o={data:O,parents:C,valid:!0,name:Z(v),form:m},a.trigger("addoption",[o]),o.valid){var N=he(v),D=[];!v.options&&v.length&&(D=J(v),Q(v).find("div").first().empty());var L=ie(v,O,m);if(v.options)v.options[v.options.length-1].selected=!0,e(v).change().focus();else if(v.length){var M;re(v),v=G(A,m),D.length>0&&oe(v,D),v.length>0&&("checkbox"!=(M=e(v).filter("[value!='{value}']").last()[0]).type&&"radio"!=M.type||M.click(),M.focus())}else if(k(v)){var F=R(v);e(v).val(T).change(),e(F.input).val(L).focus()}else if(P(v)){var $=e(v),j=e(W("lu_"+o.name,m));if($.data("multiple")){var U=e(v).val(),H=(D=[],String(T));if(""!==U&&(D=U.split(t.MULTIPLE_OPTION_SEPARATOR)),!D.includes(H)){D.push(H),$.val(D.join()).change();var Y=j.html(),B=j.find(".ew-option").map(function(){return e(this).html()}).get();B.length?(B.push(L),j.html(ne(B,$.data("maxcount")))):Y==t.language.phrase("PleaseSelect")?j.html(ae(L)):Y&&j.html(t.language.phrase("CountSelected").replace("%s",D.length))}}else $.val(T).change(),j.html(L)}var z=e(m),K=z.is("div")?"_"+z.attr("id"):"",V=z.find("#key_count"+K).val();if(V>0)for(y=1;y<=V;y++)if(y!=f){var X=G(h.replace(/^x/,"x"+y),m),q=he(X);D=[],JSON.stringify(N)==JSON.stringify(q)&&(!X.options&&X.length&&(D=J(X)),ie(X,O,m),!X.options&&X.length&&(re(X),D.length>0&&oe(X,D)))}}}}}else{var ee,te=i.find("div.ew-message-dialog").html(""),se=e("<div></div>").html(n).find("div.ew-message-dialog");se[0]?ee=se.html():((ee=r&&r.failureMessage?r.failureMessage:n)&&""!=String(ee).trim()||(ee=t.language.phrase("InsertFailed")),ee='<p class="text-danger">'+ee+"</p>"),te.html(ee).show()}},o=function(e){i.modal("hide"),N("Server Error "+e.status+": "+e.statusText)},l=function(a){var n=t.addOptionDialog.find(".modal-body form")[0],i=s[n.id],l=a?a.target:null;return l&&(i.enableForm=function(){e(l).prop("disabled",!1).removeClass("disabled")},i.disableForm=function(){e(l).prop("disabled",!0).addClass("disabled")}),i.canSubmit()&&e.post(c(t.API_ADD_ACTION),e(n).serialize(),r).fail(o).always(function(){i.enableForm()}),!1};i.modal("hide"),i.data("args",n),e.get(n.url,function(r){var o=s(n.lnk),d="x_",c=n.el.match(/^(x\d+_)/);c&&(d=c[1]);for(var u=n.el.replace(d,"x_"),p=o.lists[u].parentFields.slice(),f=o.lists[u].filterFieldVars.slice(),h=o._form,g=[],m=[],v=0,w=p.length;v<w;v++)1==p[v].split(" ").length&&(p[v]=p[v].replace(/^x_/,d));for(v=0,w=p.length;v<w;v++)g.push(J(p[v],h)),m.push(X(p[v],h));if(i.find(".modal-title").html(e(n.lnk).closest(".ew-add-opt-btn").data("title")),i.find(".modal-body").html(ce(r)),h=i.find(".modal-body form")[0])for(e(h).keypress(function(e){if(13==e.which&&"TEXTAREA"!=e.target.nodeName)return l()}),v=0,w=g.length;v<w;v++)if((x=G(f[v],h))&&(x.options||x.length)){var b=g[v];a.one("updatedone",function(t,a){var n,i,r=a.target;(x==r||(n=x,i=r,e.isArray(n)&&e.isArray(i)&&n[0]&&i[0]&&n.name==i.name&&n.form==i.form))&&oe(r,b)})}if(t.addOptionDialog=i.modal("show"),i.find(".modal-footer .btn-primary").click(l).focus(),de(r,n.el),h)for(v=0,w=g.length;v<w;v++){var x;if(x=G(f[v],h))if(k(x)){x.value=g[v][0];var _=R(x);_.input.value=m[v][0],_._options.push({val:g[v][0],lbl:m[v][0]})}else P(x)?(x.value=g[v][0],S.call(s[h.id],x)):x.options||x.length||(x.value=g[v][0])}i.trigger("load.ew")}).fail(o)}}else N("DIV #ew-add-opt-dialog not found.")},modalDialogHide:ge,modalDialogShow:function(a){e(a.lnk).tooltip("hide");var i=a.f;if(i&&!F(i))return _('<p class="text-danger">'+t.language.phrase("NoRecordSelected")+"</p>"),!1;var r=t.modalDialog||e("#ew-modal-dialog").on("hidden.bs.modal",ge);if(r.data("showing")&&r.data("url")==a.url)return!1;r.data({showing:!0,url:a.url}),a.reload=!1,"modal-sm"===a.size?r.find(".modal-dialog").toggleClass("modal-sm",!0).toggleClass("modal-lg modal-xl",!1):""===a.size?r.find(".modal-dialog").toggleClass("modal-sm modal-lg modal-xl",!1):"modal-lg"===a.size?r.find(".modal-dialog").toggleClass("modal-lg",!0).toggleClass("modal-sm modal-xl",!1):r.find(".modal-dialog").toggleClass("modal-xl",!0).toggleClass("modal-sm modal-lg",!1);var o=function(){var t=r.data("args"),a=e(t.lnk);return t.caption||a.data("caption")||a.data("original-title")||""},l=function(){var a=r.data("args");return e.isNull(a.btn)?"":a.btn&&""!=a.btn?t.language.phrase(a.btn):o()},d=function(e){r.modal("hide"),e.status&&N("Server Error "+e.status+": "+e.statusText)},c=function(e){n.css("cursor","default")},u=function(a){var i=b(a);if(e.isObject(i)){var o=i.url;if(i.modal&&!function(t){var a=e("<a>",{href:t})[0];return window.location.pathname.endsWith(a.pathname)}(o)){var s=r.data("args");s.reload=!0,i.caption&&(s.caption=i.caption),s.btn=i.view?null:"",r.data("args",s),o+=(o.split("?").length>1?"&":"?")+"modal=1&rnd="+Me(),n.css("cursor","wait"),e.ajax(o).done(f).fail(d).always(c)}else r.modal("hide"),window.location=o}else{var u=fe(a),h=r.find(".modal-body").html(u),g="",m=h.find("#confirm"),v=h.find("#conflict");if(v&&"1"==v.val())g+='<button type="button" id="btn-overwrite" class="btn btn-primary ew-btn">'+t.language.phrase("OverwriteBtn")+"</button>",g+='<button type="button" id="btn-reload" class="btn btn-default ew-btn">'+t.language.phrase("ReloadBtn")+"</button>",g+='<button type="button" class="btn btn-default ew-btn" data-dismiss="modal">'+t.language.phrase("CancelBtn")+"</button>",r.find(".modal-footer").html(g),r.find(".modal-footer #btn-overwrite").on("click",{action:"overwrite"},p),r.find(".modal-footer #btn-reload").on("click",{action:"show"},p);else if(m&&"confirm"==m.val())g+='<button type="button" class="btn btn-primary ew-btn">'+t.language.phrase("ConfirmBtn")+"</button>",g+='<button type="button" class="btn btn-default ew-btn">'+t.language.phrase("CancelBtn")+"</button>",r.find(".modal-footer").html(g),r.find(".modal-footer .btn-primary").click(p).focus(),r.find(".modal-footer .btn-default").on("click",{action:"cancel"},p);else{var w=l();w&&(g+='<button type="button" class="btn btn-primary ew-btn">'+w+"</button>"),g+='<button type="button" class="btn btn-default ew-btn" data-dismiss="modal">'+t.language.phrase("CancelBtn")+"</button>",r.find(".modal-footer").html(g),r.find(".modal-footer .btn-primary").addClass("ew-submit").click(p).focus()}de(a,"ModalDialog"),r.trigger("load.ew")}},p=function(t){var a=r.find(".modal-body form")[0],n=e(a),i=s[a.id],o=t&&t.data?t.data.action:null,l=t?t.target:null;l&&(i.enableForm=function(){e(l).prop("disabled",!1).removeClass("disabled")},i.disableForm=function(){e(l).prop("disabled",!0).addClass("disabled")});var p=a.elements.action;return o&&p&&(p.value=o),"cancel"==o?e.post(n.attr("action"),n.serialize(),f).fail(d).always(c):i.canSubmit()&&e.post(n.attr("action"),n.serialize(),u).fail(d),!1};r.modal("hide"),r.data("args",a);var f=function(a){var n=b(a);if(e.isObject(n))n.error&&N(n.error);else{var i=r.data("args"),s=(e(a),e(i.lnk));r.find(".modal-title").html(o());var d="",c=l();c&&(d+='<button type="button" class="btn btn-primary ew-btn">'+c+"</button>"),""!=d?d+='<button type="button" class="btn btn-default ew-btn" data-dismiss="modal">'+t.language.phrase("CancelBtn")+"</button>":d='<button type="button" class="btn btn-default ew-btn" data-dismiss="modal">'+t.language.phrase("CloseBtn")+"</button>",r.find(".modal-footer").html(d);var u=fe(a);r.find(".modal-body").html(u),r.find(".modal-body form").keypress(function(e){if(13==e.which&&"TEXTAREA"!=e.target.nodeName)return p()}),t.modalDialog=r.modal("show"),r.find(".modal-dialog").addClass("table-"+s.data("table")),r.find(".modal-footer .btn-primary").addClass("ew-submit").click(p).focus(),de(a,"ModalDialog"),r.trigger("load.ew")}};n.css("cursor","wait");var h=a.url;if(i){var g=e(i);i.elements.modal||e("<input>").attr({type:"hidden",name:"modal",value:"1"}).appendTo(g),e.post(h,g.serialize(),f).fail(d).always(c)}else h+=(h.split("?").length>1?"&":"?")+"modal=1&rnd="+Me(),e.get(h,f).fail(d).always(c);return!1},modalLookupShow:function(a){var i=a.el,r=E(a.lnk);if(r&&i){var o=t.modalLookupDialog||e("#ew-modal-lookup-dialog").on("hidden.bs.modal",ge);if(o[0]){if(!o.data("showing")){o.data("showing",!0),Z(i,!0);var l,d,u=e(r).find("[id='"+i+"']"),p=o.find(".modal-body"),f=e(a.lnk),h=f.closest(".ew-lookup-list").find(".ew-lookup-text").focus(),g=Z(i,!1),m=g.match(/^([xy])(\d*)_/),v=(m&&m[1],m?m[2]:""),w=g.replace(/^([xy])(\d*)_/,"x_"),b=s[r.id].lists(w),x=function(a){return"OK"==a.result&&e.isArray(a.records)&&a.records.forEach(function(n,i){var r;e.isArray(n)?r={lf:n[0],df1:n[1],df2:n[2],df3:n[3],df4:n[4]}:e.isObject(n)&&(r={lf:n.lf,df1:n.df,df2:n.df2,df3:n.df3,df4:n.df4});var o=te(n,u);b.template?r.df=b.template.render(r,t.jsRenderHelpers):r.df=o,r.txt=o,a.records[i]=r}),a},_=function(e,t){if(k(u)){var a=R(u[0]);a._options.push({val:e,lbl:t}),a.input.value=t}},y=function(){return function(i){var o=[],s=[],l=[],d=[],f=!a.m&&a.srch;if(p.ewjtable("selectedRows").each(function(){var t=e(this).data("record");o.push(t.lf),s.push(t.df),l.push(t.df),d.push(t.txt)}),i.sort().join()===o.sort().join())h.html(ne(l,u.data("maxcount"))),_(o.join(),d.join(", ")),u.val(f?s.join(", "):o.join()).change();else{var m=t.extend({page:b.page,field:b.field,ajax:"modal",keys:i},O("#p_"+g,r));n.css("cursor","wait"),e.ajax(c(t.API_LOOKUP_ACTION),{type:"POST",dataType:"json",data:m}).done(x).then(function(t){if("OK"==t.result&&e.isArray(t.records)){for(var a=[],n=[],i=[],r=[],o=t.records,s=0,l=o.length;s<l;s++){var d=o[s];a.push(d.lf),n.push(d.df),i.push(d.df),r.push(d.txt)}h.html(ne(i,u.data("maxcount"))),_(a.join(),r.join(", ")),u.val(f?n.join(", "):a.join()).change()}}).always(function(){n.css("cursor","default")})}}(A),o.modal("hide"),!1};o.modal("hide"),o.data("args",a);var S=[],T=u.val(),A=""!==T?T.split(t.MULTIPLE_OPTION_SEPARATOR):[],I=t.extend({page:b.page,field:b.field},O("#p_"+g,r)),C=b.parentFields.slice();if(""!=v)for(var P=0,D=C.length;P<D;P++)1==C[P].split(" ").length&&(C[P]=C[P].replace(/^x_/,"x"+v+"_"));if(C.length>0)for(P=0,D=C.length;P<D;P++)S.push(J(C[P],r));P=0;for(var L=S.length;P<L;P++)I["v"+(P+1)]=S[P].join(t.MULTIPLE_OPTION_SEPARATOR);n.css("cursor","wait"),p.ewjtable({paging:!0,pageSize:a.n,pageSizes:[],pageSizeChangeArea:!1,pageList:"minimal",selecting:!0,selectingCheckboxes:!0,multiselect:!!a.m,actions:{listAction:function(a,i){var r=t.extend({},I,{ajax:"modal",start:i.start,recperpage:i.recperpage});return e.isObject(a)&&t.extend(r,a),e.ajax(c(t.API_LOOKUP_ACTION),{type:"POST",dataType:"json",data:r}).done(x).always(function(){n.css("cursor","default")})}},messages:{serverCommunicationError:t.language.phrase("ServerCommunicationError"),loadingMessage:'<div class="'+t.spinnerClass+' m-3 ew-loading" role="status"><span class="sr-only">'+t.language.phrase("Loading")+"</span></div>",noDataAvailable:t.language.phrase("NoRecord"),close:t.language.phrase("CloseBtn"),pagingInfo:t.language.phrase("Record")+" {0}-{1} "+t.language.phrase("Of")+" {2}",pageSizeChangeLabel:t.language.phrase("RecordsPerPage"),gotoPageLabel:t.language.phrase("Page")},fields:{lf:{key:!0,list:!1},df:{}},recordsLoaded:function(t,a){var n=e(t.target).find(".ewjtable-data-row").filter(function(){return A.includes(String(e(this).data("record-key")))});e(t.target).ewjtable("selectRows",n)},selectionChanged:function(t,n){var i=n.rows;i&&(a.m||(A=[]),i.each(function(){var t=e(this),a=String(t.data("record-key")),n=A.indexOf(a),i=t.hasClass("ewjtable-row-selected");i&&-1==n?A.push(a):!i&&n>-1&&A.splice(n,1)}))}}).ewjtable("load",null,function(a){"OK"==a.result?(o.find(".modal-title").html(f.attr("title")||f.data("original-title")),o.find(".modal-footer").html('<button type="button" id="btn-select" class="btn btn-primary ew-btn">'+t.language.phrase("SelectBtn")+'</button><button type="button" class="btn btn-default ew-btn" data-dismiss="modal">'+t.language.phrase("CancelBtn")+"</button>"),d=e('<input type="search" name="sv" class="form-control mb-2" placeholder="'+t.language.phrase("Search")+'">').prependTo(p).on("keyup",function(a){l&&l.cancel(),l=e.later(t.LOOKUP_DELAY,null,function(){p.ewjtable("load",{sv:d.val()})})}),o.find(".modal-footer #btn-select").click(y),t.modalLookupDialog=o.modal("show"),o.find("[name=sv]").focus()):N(a.message)})}}else N("DIV #ew-modal-lookup-dialog not found.")}},importDialogShow:function(a){e(a.lnk).tooltip("hide");var i=t.importDialog||e("#ew-import-dialog");if(!i[0])return N("DIV #ew-import-dialog not found."),!1;var r,o=i.find("#importfiles"),s=i.find(".modal-body"),l=s.find(":input[id!=importfiles]"),d=s.find(".message"),u=s.find(".progress"),p=function(t,a){$msg=e("<div>"+t+"</div>"),a&&$msg.addClass(a),d.removeClass("d-none").html($msg),"text-danger"==a&&i.find(".modal-footer .btn").prop("disabled",!1)},f=function(){d.addClass("d-none").html("")},h=function(e,t){u.removeClass("d-none").find(".progress-bar").removeClass("bg-success bg-info").addClass(t||"bg-success").attr("aria-valuenow",e).css("width",e+"%").html(e+"%")},g=function(e){try{var a=parseInt(e.count),n=parseInt(e.totalCount),r=e.file;if(n>0&&i.find(".modal-footer .ew-close-btn").data("import-progress")){var o=parseInt(100*a/n);h(o),p(t.language.phrase("ImportMessageProgress").replace("%t",n).replace("%c",a).replace("%f",r),"text-info")}}catch(e){}},m=function(){var a=c(t.API_PROGRESS_ACTION),n={rnd:Me()};n[t.API_FILE_TOKEN_NAME]=o.data(t.API_FILE_TOKEN_NAME),e.get(a,n,g,"json")},v=function(a){var n="";h(100);var r=a.files;if(i.find(".modal-footer .ew-close-btn").data("import-progress",!1),e.isArray(r))for(var o=0,s=r.length;o<s;o++){var l=r[o],d=l.totalCount||0,c=l.count||0,f=l.successCount||0,g=l.failCount||0;if(""!=n&&(n+="<br>"),l.success)n+=t.language.phrase("ImportMessageSuccess").replace("%t",d).replace("%c",c).replace("%f",l.file);else{n+=t.language.phrase("ImportMessageError1").replace("%t",d).replace("%c",c).replace("%f",l.file).replace("%s",f).replace("%e",g),l.error&&(n+=t.language.phrase("ImportMessageError2").replace("%e",l.error));var m=!0;if(l.failList){var v=0;for(o=1;o<=c&&(l.failList["row"+o]&&(v+=1,n+="<br>"+t.language.phrase("ImportMessageError3").replace("%i",o).replace("%d",l.failList["row"+o])),!(v>=5));o++);g>5?n+="<br>"+t.language.phrase("ImportMessageMore").replace("%s",g-5):m=!1}l.log&&m&&(n+="<br>"+t.language.phrase("ImportMessageError4").replace("%l",l.log)),p(n,"text-danger")}}a.success?(p(n,"text-success"),i.find(".modal-footer .ew-close-btn").data("imported",!0)):(a.error&&(n=a.error),p(n,"text-danger")),u.addClass("d-none").find(".progress-bar").attr("aria-valuenow",0).css("width","0%").html("0%")},w=function(e){i.find(".modal-footer .ew-close-btn").data("import-progress",!1),p(t.language.phrase("ImportMessageServerError").replace("%s",e.status).replace("%t",e.statusText),"text-danger")},b={session:t.SESSION_ID};b[t.TOKEN_NAME]=t.ANTIFORGERY_TOKEN;var x=t.importUploadOptions;return x.acceptFileTypes||(x.acceptFileTypes=new RegExp("\\.("+t.IMPORT_FILE_ALLOWED_EXT.replace(/,/g,"|")+")$","i")),o.data("blueimpFileupload")||o.fileupload(t.extend({url:c(t.API_UPLOAD_ACTION),dataType:"json",autoUpload:!0,formData:b,singleFileUploads:!1,messages:{acceptFileTypes:t.language.phrase("UploadErrMsgAcceptFileTypes"),maxFileSize:t.language.phrase("UploadErrMsgMaxFileSize"),maxNumberOfFiles:t.language.phrase("UploadErrMsgMaxNumberOfFiles"),minFileSize:t.language.phrase("UploadErrMsgMinFileSize")},done:function(a,s){if(s.result&&s.result.files&&e.isArray(s.result.files.importfiles)){var d=!0;s.result.files.importfiles.forEach(function(e,a){e.error&&(p(t.language.phrase("ImportMessageUploadError").replace("%f",e.name).replace("%s",e.error),"text-danger"),d=!1)}),d&&function(a){n.css("cursor","wait"),o.data(t.API_FILE_TOKEN_NAME,a),i.find(".modal-footer .ew-close-btn").data("import-progress",!0);var s=t.API_ACTION_NAME+"=import&"+t.API_FILE_TOKEN_NAME+"="+encodeURIComponent(a);l.length&&(s+="&"+l.serialize()),e.ajax(we(),{data:s,method:"POST",dataType:"json",beforeSend:function(t,a){r=e.later(100,null,m,null,!0)}}).done(v).fail(w).always(function(){n.css("cursor","default"),r&&r.cancel()})}(s.result[t.API_FILE_TOKEN_NAME])}},change:function(e,t){f()},processfail:function(e,a){a.files.forEach(function(e,a){e.error&&p(t.language.phrase("ImportMessageUploadError").replace("%f",e.name).replace("%s",e.error),"text-danger")})},fail:function(e,a){p(t.language.phrase("ImportMessageServerError").replace("%s",a.textStatus).replace("%t",a.errorThrown),"text-danger")},progressall:function(e,a){!function(e){var a=parseInt(100*e.loaded/e.total);h(a,"bg-info"),p(100===a?t.language.phrase("ImportMessageUploadComplete"):t.language.phrase("ImportMessageUploadProgress").replace("%p",a),"text-info")}(a)}},x)),i.modal("hide").find(".modal-title").html(a.hdr),i.find(".modal-footer .ew-close-btn").off("click.ew").on("click.ew",function(){var t=e(this);t.data("imported")&&(t.data("imported",!1),window.location.reload(!0))}),f(),t.importDialog=i.modal("show"),!1},autoFill:me,tooltip:ve,emailDialogShow:function(a){var n=t.emailDialog||e("#ew-email-dialog");if(!n[0])return N("DIV #ew-email-dialog not found."),!1;if(a.sel&&!F(a.f))return N(t.language.phrase("NoRecordSelected")),!1;var i=n.find(".modal-body form"),r=i.data("form");return r||((r=new x(i.attr("id"))).validate=function(){var e,a=this.getForm();return(e=a.elements.sender)&&!M(e)?this.onError(e,t.language.phrase("EnterSenderEmail")):e&&!Ne(e.value,1)?this.onError(e,t.language.phrase("EnterProperSenderEmail")):(e=a.elements.recipient)&&!M(e)?this.onError(e,t.language.phrase("EnterRecipientEmail")):e&&!Ne(e.value,t.MAX_EMAIL_RECIPIENT)?this.onError(e,t.language.phrase("EnterProperRecipientEmail")):(e=a.elements.cc)&&!Ne(e.value,t.MAX_EMAIL_RECIPIENT)?this.onError(e,t.language.phrase("EnterProperCcEmail")):(e=a.elements.bcc)&&!Ne(e.value,t.MAX_EMAIL_RECIPIENT)?this.onError(e,t.language.phrase("EnterProperBccEmail")):!((e=a.elements.subject)&&!M(e))||this.onError(e,t.language.phrase("EnterSubject"))},r.submit=function(){if(!this.validate())return!1;var r=i.serialize(),o="";a.f&&a.sel&&(o=e(a.f).find("input[type=checkbox][name='key_m[]']:checked").serialize()),a.key&&(r+="&"+e.param(a.key));var s=this.getForm();return a.url?(n.modal("hide"),a.exportid?t.exportWithCharts(a.el,a.url,a.exportid,s):I(a.f,a.url,"email",!0,a.sel,s)):e.post(e(a.f).attr("action"),r+"&"+o,function(e){Le(e)}),!0},i.data("form",r)),n.modal("hide").find(".modal-title").html(a.hdr),n.find(".modal-footer .btn-primary").unbind().click(function(e){e.preventDefault(),r.submit()&&n.modal("hide")}),t.emailDialog=n.modal("show"),!1},showDrillDown:function(i,r,o,s,l){if(i&&i.ctrlKey){var d=o.split("?"),c=new URLSearchParams(d[1]);return c.set("d","2"),t.redirect(d[0]+"?"+c.toString()),!1}var u=e.isString(r)?e("#"+r):e(r),p=u.data("drilldown-placement")||(u.hasClass("ew-chart-canvas")?t.CSS_FLIP?"left":"right":"bottom");u.tooltip("hide");var f={obj:u[0],id:s,url:o,hdr:l,placement:p};a.trigger("drilldown",[f]);var h=f.url.split("?");f.file=h[0]||"",f.data=h[1]||"",u.data("bs.popover")||u.popover({html:!0,placement:f.placement,trigger:"manual",template:'<div class="popover"><h3 class="popover-header d-none" style="cursor: move;"></h3><div class="popover-body"></div></div>',content:'<div class="'+t.spinnerClass+' m-3 ew-loading" role="status"><span class="sr-only">'+t.language.phrase("Loading")+"</span></div>",container:e("#ew-drilldown-panel"),sanitizeFn:t.sanitizeFn,boundary:"viewport"}).on("show.bs.popover",function(e){u.attr("data-original-title","")}).on("shown.bs.popover",function(a){if(u.data("args")){var i=u.data("args").data;i+=(i?"&":"")+t.TOKEN_NAME+"="+t.ANTIFORGERY_TOKEN,e.ajax({cache:!1,dataType:"html",type:"POST",data:i,url:u.data("args").file,success:function(a){var i=e(u.data("bs.popover").getTipElement()).on("mousedown",function(t){var a=e(this).addClass("drag"),i=a.outerHeight(),r=a.outerWidth(),o=a.offset().top+i-t.pageY,s=a.offset().left+r-t.pageX;n.on("mousemove",function(e){var t=e.pageY+o-i,n=e.pageX+s-r;a.hasClass("drag")&&a.offset({top:t,left:n})}).on("mouseup",function(e){a.removeClass("drag")})});f.hdr&&i.find(".popover-header").empty().removeClass("d-none").append('<button type="button" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></button>'+f.hdr).find(".close").click(function(){u.popover("hide")});var r=a.match(/<body[^>]*>([\s\S]*?)<\/body\s*>/i);a=r?r[0]:a;var o=t.stripScript(a);i.find(".popover-body").html(e("<div></div>").html(o).find("#ew-report")).find(".ew-table").each(t.setupTable),t.executeScript(a,s),u.popover("update")},error:function(t){t.responseText&&e($el.data("bs.popover").getTipElement()).find(".popover-body").empty().append('<p class="text-danger">'+t.responseText+"</p>")}})}}).on("hidden.bs.popover",function(a){e.each(t.drillDownCharts,function(e,t){t.dispose()}),t.drillDownCharts={},t.removeScript(s)}),u.data("args",f).popover("show")},toggleGroup:function(t){for(var a,n=e(t),i=n.closest("tr"),r="tr",o=1;o<=6;o++){var s=1==o?"":"-"+o,l=i.data("group"+s);e.isValue(l)&&(a=o,""!=l&&(r+="[data-group"+s+"='"+String(l).replace(/'/g,"\\'")+"']"))}n.hasClass("icon-collapse")?(e(r).slice(1).addClass("ew-rpt-grp-hide-"+a),n.toggleClass("icon-expand icon-collapse")):(e(r).slice(1).removeClass("ew-rpt-grp-hide-"+a),n.toggleClass("icon-expand icon-collapse"))},exportWithCharts:function(a,i,r,o){var s=a.target;r+="_"+Date.now(),i+=(i.split("?").length>1?"&":"?")+"exportid="+r;var l=we(),d=l.substring(0,l.lastIndexOf("/")+1);i=d+i;var u=e(s),p=o?"post":"get";u.is(".dropdown-menu a")&&(u=u.closest(".btn-group"));var f=function(){var a=i.replace(/&amp;/g,"&"),r=new URL(a),s=r.searchParams,l="1"==s.get("custom");if(o&&!l){var d=e(o).serialize();e.post(a,d,function(e){t.showMessage(e)})}else{var c=s.get("export");l&&["word","excel","pdf","email"].includes(c)?("email"==c&&(s.delete("export"),a=r.toString()+"&"+e(o).serialize()),e("iframe.ew-export").remove(),e("<iframe></iframe>").addClass("ew-export d-none").attr("src",a).appendTo(n.css("cursor","wait")),setTimeout(function(){n.css("cursor","default")},5e3)):"print"==c?t.redirect(a,o,p):t.fileDownload(a,null)}return!1},h=Object.keys(window.exportCharts);if(0==h.length)return f();n.css("cursor","wait");for(var g=[],m=0;m<h.length;m++){var v=h[m],w=window.exportCharts[v],x="exportfilename="+r+"_"+v+".png|exportformat=png|exportaction=download|exportparameters=undefined";w&&w.toBase64Image&&g.push({chart_engine:"Chart.js",stream_type:"base64",stream:w.toBase64Image(),parameters:x})}return e.ajax({url:c(t.API_EXPORT_CHART_ACTION),data:{charts:JSON.stringify(g)},cache:!1,type:"POST"}).done(function(a){e.isString(a)&&(a=b(a)),a.success?f():t.alert(a.error)}).fail(function(e,a,n){t.alert(n+": "+e.responseText)}).always(function(){e("#ew-message-box").find(".modal-footer button").prop("disabled",!1),n.css("cursor","default")}),!1},redirect:function(a,n,i){var r=a.split("?"),o=new URLSearchParams(r[1]);if(o.set(t.TOKEN_NAME,t.ANTIFORGERY_TOKEN),V(i,"post")){var s=n?e(n):e("<form></form>").appendTo("body");s.attr({action:r[0],method:"post"}),o.forEach(function(t,a){e('<input type="hidden">').attr({name:a,value:sanitize(t)}).appendTo(s)}),s.submit()}else{var l=o.toString();window.location=r[0]+(l?"?"+l:"")}},togglePassword:function(t){var a=e(t.currentTarget),n=a.closest(".input-group").find("input"),i=a.find("i");"text"==n.attr("type")?(n.attr("type","password"),i.toggleClass("fa-eye-slash fa-eye")):"password"==n.attr("type")&&(n.attr("type","text"),i.toggleClass("fa-eye-slash fa-eye"))},ajax:function(a,n){if(e.isObject(a)){var i=a.action;if(i){delete a.action;var r=t.extend({},a),o=function(t){if(e.isObject(t)&&"OK"==t.result){var a=t.records;return e.isArray(a)&&1==a.length?(a=a[0],e.isArray(a)&&1==a.length?a[0]:a):a}return t},s=c(i);if(!e.isFunction(n)){var l=e.ajax({url:s,async:!1,type:"POST",data:r}).responseText;return l=b(l),o(l)}e.post(s,r,function(e){n(o(e))},"json")}}},currentPage:we,toggleSearchOperator:function(e,t){var a=this.form.elements[e];a&&(a.value=a.value!=t?t:"=")},checkUSDate:be,checkShortUSDate:xe,checkDate:_e,checkShortDate:Ee,checkEuroDate:ye,checkShortEuroDate:Se,checkDateDef:function(e){return t.DATE_FORMAT.match(/^yyyy/)?_e(e):t.DATE_FORMAT.match(/^yy/)?Ee(e):t.DATE_FORMAT.match(/^m/)&&t.DATE_FORMAT.match(/yyyy$/)?be(e):t.DATE_FORMAT.match(/^m/)&&t.DATE_FORMAT.match(/yy$/)?xe(e):t.DATE_FORMAT.match(/^d/)&&t.DATE_FORMAT.match(/yyyy$/)?ye(e):!(!t.DATE_FORMAT.match(/^d/)||!t.DATE_FORMAT.match(/yy$/))&&Se(e)},checkDateEx:Te,unformatYear:Oe,checkDay:Ae,checkInteger:function(e){return!e||0==e.length||!e.includes(t.DECIMAL_POINT)&&Ie(e)},checkNumber:Ie,stringToFloat:Ce,stringToDate:function(e){var t=e.replace(/^(\d{4})-([0][1-9]|[1][0-2])-([0][1-9]|[1|2]\d|[3][0|1]) (?:(0\d|1\d|2[0-3]):([0-5]\d):([0-5]\d))?$/,"$1 $2 $3 $4 $5 $6").split(" ");return new Date(t[0],t[1]-1,t[2],t[3],t[4],t[5])},escapeRegExChars:Pe,checkRange:ke,checkTime:Re,checkPhone:function(e){return!e||0==e.length||/^\(\d{3}\) ?\d{3}( |-)?\d{4}|^\d{3}( |-)?\d{3}( |-)?\d{4}$/.test(e.trim())},checkZip:function(e){return!e||0==e.length||/^\d{5}$|^\d{5}-\d{4}$/.test(e.trim())},checkCreditCard:function(e){if(!e||0==e.length)return!0;var t=e.replace(/\D/g,"");if(0==t.length)return!1;for(var a,n=t.length%2!=1,i=0,r=0,o=t.length;r<o;r++)a=parseInt(t.charAt(r),10),n?(i+=(a*=2)%10,a/10>=1&&i++,n=!1):(i+=a,n=!0);return i%10==0},checkSsc:function(e){return!e||0==e.length||/^(?!000)([0-6]\d{2}|7([0-6]\d|7[012]))([ -]?)(?!00)\d\d\3(?!0000)\d{4}$/.test(e.trim())},checkEmails:Ne,checkEmail:De,checkGuid:function(e){return!e||0==e.length||/^(\{\w{8}-\w{4}-\w{4}-\w{4}-\w{12}\}|\w{8}-\w{4}-\w{4}-\w{4}-\w{12})$/.test(e.trim())},checkByRegEx:function(e,t){return!e||0==e.length||!!e.match(t)},showMessage:Le,random:Me,upload:Fe,parseNumber:function(a,n){if(e.isString(a)){var i,r=[],o=(n=n||{thousandsSeparator:t.THOUSANDS_SEP,decimalSeparator:t.DECIMAL_POINT}).thousandsSeparator,s=n.decimalSeparator;o&&r.push(Pe(o)+"(?=\\d)"),i=new RegExp("(?:"+r.join("|")+")","g"),"."===s&&(s=null),a=a.replace(i,""),a=s?a.replace(s,"."):a}return e.isString(a)&&""!==a.trim()&&(a=+a),e.isNumber&&isFinite(a)||(a=null),a},formatNumber:function(a,n){if(e.isNumber(a)){var i,r,o,s,l=a<0,d=a+"",c=(n=n||{thousandsSeparator:t.THOUSANDS_SEP,decimalSeparator:t.DECIMAL_POINT}).decimalPlaces,u=n.decimalSeparator||".",p=n.thousandsSeparator;if(e.isNumber(c)&&c>=0&&c<=20&&(d=a.toFixed(c)),"."!==u&&(d=d.replace(".",u)),p){for(i=(i=d.lastIndexOf(u))>-1?i:d.length,r=d.substring(i),o=0,s=i;s>0;s--)o%3==0&&s!==i&&(!l||s>1)&&(r=p+r),r=d.charAt(s-1)+r,o++;d=r}return d}return e.isValue(a)&&a.toString?a.toString():""},parseDate:function(a,n){var i=e.makeArray(arguments);if(e.isNumber(n)&&n>=0&&n<=17){var r,o=t.DATE_FORMAT.toUpperCase(),s=t.DATE_SEPARATOR,l=t.TIME_SEPARATOR;switch(n){case 0:case 1:case 2:case 8:r=o+" HH"+l+"mm"+l+"ss";break;case 3:r="hh:mm:ss A";break;case 4:r="HH:mm:ss";break;case 5:r="YYYY"+s+"MM"+s+"DD";break;case 6:r="MM"+s+"DD"+s+"YYYY";break;case 7:r="DD"+s+"MM"+s+"YYYY";break;case 9:r="YYYY"+s+"MM"+s+"DD HH"+l+"mm"+l+"ss";break;case 10:r="MM"+s+"DD"+s+"YYYY HH"+l+"mm"+l+"ss";break;case 11:r="DD"+s+"MM"+s+"YYYY HH"+l+"mm"+l+"ss";break;case 12:r="YY"+s+"MM"+s+"DD";break;case 13:r="MM"+s+"DD"+s+"YY";break;case 14:r="DD"+s+"MM"+s+"YY";break;case 15:r="YY"+s+"MM"+s+"DD HH"+l+"mm"+l+"ss";break;case 16:r="MM"+s+"DD"+s+"YY HH"+l+"mm"+l+"ss";break;case 17:r="DD"+s+"MM"+s+"YY HH"+l+"mm"+l+"ss"}i[1]=[r,"YYYY-MM-DD HH"+l+"mm"+l+"ss"]}return moment.apply(this,i)},formatDate:function(e,a){return moment(e).format(a||t.DATE_FORMAT.toUpperCase())},fixLayoutHeight:function(){je&&je.cancel(),je=e.later(50,null,function(){var e=n.data("lte.layout");e&&e.fixLayoutHeight()})},Layout:Ue}}(jQuery,ew)),jQuery.extend({isBoolean:function(e){return"boolean"==typeof e},isNull:function(e){return null===e},isNumber:function(e){return"number"==typeof e&&isFinite(e)},isObject:function(e){return e&&("object"==typeof e||this.isFunction(e))||!1},isString:function(e){return"string"==typeof e},isUndefined:function(e){return void 0===e},isValue:function(e){return this.isObject(e)||this.isString(e)||this.isNumber(e)||this.isBoolean(e)},isDate:function(e){return"date"===this.type(e)&&"Invalid Date"!==e.toString()&&!isNaN(e)},later:function(e,t,a,n,i){e=e||0,t=t||{};var r,o,s=a,l=n;if(this.isString(a)&&(s=t[a]),s)return this.isUndefined(n)||this.isArray(l)||(l=[n]),r=function(){s.apply(t,l||[])},o=i?setInterval(r,e):setTimeout(r,e),{interval:i,cancel:function(){this.interval?clearInterval(o):clearTimeout(o)}}}}),function(e,t){e.fn.fields=function(a){var n,i,r,o={},s=this.attr("id"),l=this[0],d=s.match(/^[xy](\d*)_/);d?(n=t.getForm(l),i=this.data("table"),r=d[1]):l&&l._form&&(n=l.$element,i=l.id.replace(new RegExp("^f|"+l.pageId+"$","g"),""),r=e(l._form).data("rowindex"));var c="[data-table="+i+"][data-field"+(a?"=x_"+a:"")+"]";return e.isValue(r)&&(c+="[name^=x"+r+"_]"),n&&c&&e(n).find(c).each(function(){var t=this.getAttribute("data-field").substr(2),a=this.getAttribute("name");t=/^y_/.test(a)?"y_"+t:t,o[t]=o[t]?o[t].add(this):e(this)}),a?o[a]:o},e.fn.extend({row:function(){var e=this.closest("#r_"+this.data("field").substr(2));return e[0]||(e=this.closest(".ew-table > tbody > tr")),e},visible:function(e){var t=this.closest("#r_"+this.data("field").substr(2));return t[0]||(t=this.closest("[id^=el]")),void 0!==e?(t.toggle(e),this):t.is(":visible")},readonly:function(e){return void 0!==e?(this.prop("readOnly",e),this):this.prop("readOnly")},disabled:function(e){return void 0!==e?(this.prop("disabled",e),this):this.prop("disabled")},value:function(a){var n=this.attr("type");if(void 0!==a){e.isArray(a)||(a=[a]);var i="radio"==(n=this.attr("type"))||"checkbox"==n?this.get():this[0];return t.selectOption(i,a),this}return"checkbox"==n?t.getOptionValues(this.get()):"radio"==n?t.getOptionValues(this.get()).join():t.isHiddenTextArea(this)?(this.data("editor").save(),this.val()):this.val()},toNumber:function(){return t.parseNumber(this.value())},toDate:function(){return t.parseDate(this.value(),this.data("format"))},toJsDate:function(){return t.parseDate(this.value(),this.data("format")).toDate()}})}(jQuery,ew),function(e,t){e("ul.dropdown-menu [data-toggle=dropdown]").on("click",function(t){var a=e(this).attr("href");a&&"#"!=a&&"SPAN"==t.target.nodeName&&(window.location=a)})}(jQuery,ew);